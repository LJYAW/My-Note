(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ba0b140"],{"3c31":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"client-style"},[s("p",[t._v("客户推送状态：")]),t._l(t.list,(function(e,a){return s("div",{key:a},[s("span",{staticClass:"text",style:e.style},[t._v(t._s(e.text))])])}))],2)},i=[],n={name:"ClientStatus",data:function(){return{list:[{text:"推送成功",style:{color:"#67C23A"}},{text:"待推送",style:{color:"#E6A23C"}},{text:"推送失败",style:{color:"#F56C6C"}}]}}},l=n,o=(s("9487"),s("4ac2")),c=Object(o["a"])(l,a,i,!1,null,"0ffdfdc4",null);e["a"]=c.exports},4290:function(t,e,s){"use strict";s("bd0e")},"516c":function(t,e,s){},"70cb":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-met"},[s("div",{staticClass:"search-top"},[s("div",[s("div",{staticClass:"search-list"},[s("div",{staticClass:"item-serach"},[s("span",{staticClass:"item-label"},[t._v("视频标题:")]),s("el-input",{attrs:{placeholder:"请输入视频标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),s("div",{staticClass:"item-serach"},[s("span",{staticClass:"item-label"},[t._v("转码状态:")]),s("el-select",{attrs:{filterable:"",placeholder:"请选择转码状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.status_options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),s("div",{staticClass:"item-serach"},[s("span",{staticClass:"item-label"},[t._v("推送状态:")]),s("el-select",{attrs:{filterable:"",placeholder:"请选择推送状态"},model:{value:t.form.send,callback:function(e){t.$set(t.form,"send",e)},expression:"form.send"}},t._l(t.send_options,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),s("div",{staticClass:"btns"},[s("base-btn",{attrs:{size:"big"},on:{click:function(e){return t.search()}}},[t._v("搜索")])],1)])])]),s("div",{staticStyle:{"margin-top":"20px"}},[s("clientStatus",{ref:"clientStatus"}),s("el-table",{staticClass:"table-list",attrs:{data:t.tableData,border:""}},[s("el-table-column",{attrs:{prop:"channel_name",label:"频道"}}),s("el-table-column",{attrs:{prop:"item_name",label:"栏目"}}),s("el-table-column",{attrs:{prop:"title",label:"视频标题"}}),s("el-table-column",{attrs:{prop:"status",label:"转码状态"}}),s("el-table-column",{attrs:{prop:"department_name",label:"团队"}}),s("el-table-column",{attrs:{prop:"executor_name",label:"执行人"}}),s("el-table-column",{attrs:{prop:"customers",label:"客户","class-name":"client-col"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.push_customers,(function(a,i){return s("div",{key:i,staticClass:"client-name"},[s("el-popover",{key:i,ref:"popover",refInFor:!0,attrs:{trigger:"click",placement:"top"},model:{value:a.visible,callback:function(e){t.$set(a,"visible",e)},expression:"client.visible"}},[s("p",{staticStyle:{padding:"20px"}},[t._v(t._s(a.customer_name))]),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){a.visible=!1}}},[t._v("取消")]),s("el-button",{attrs:{type:"text",size:"mini",disabled:"转码成功"!==e.row.status},on:{click:function(s){return t.resetSend(a,e.row.isPush)}}},[t._v("重新推送")])],1),s("a",{staticClass:"text customers-hover",style:t.clientStatus.find((function(t){return t.text==a.push_status})).style,attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(a.customer_name)+" ")])])],1)}))}}])}),s("el-table-column",{attrs:{prop:"",label:"操作",width:"260px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("base-btn",{staticClass:"start-task",attrs:{disabled:"转码成功"!==e.row.status,type:"text"},on:{click:function(s){return t.playVideo(e)}}},[t._v("播放视频")]),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.isPush?"推送开启中":"推送关闭中",placement:"top-start"}},[s("base-btn",{attrs:{type:"text"}},[s("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(s){return t.changeSwitch(s,e)}},model:{value:e.row.isPush,callback:function(s){t.$set(e.row,"isPush",s)},expression:"scope.row.isPush"}})],1)],1)]}}])})],1)],1),s("div",{staticClass:"pagination-list"},[s("base-pag",{attrs:{total:t.total,limit:t.limit,page:t.page},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1),s("playVideo",{ref:"playVideo"})],1)},i=[],n=(s("08ba"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("base-dialog",{attrs:{show:t.show,title:t.videoData.title,width:t.dialogsObj.width,center:t.dialogsObj.center},on:{close:t.close}},[s("div",{staticClass:"videoModel"},[s("div",{staticClass:"videoBox"},[t.videoData.video_url?s("video",{ref:"video",attrs:{src:t.videoData.video_url,controls:"",disablePictureInPicture:!0,controlsList:"nodownload noremoteplayback"}}):s("div",[t._v("糟糕，视频跑路了，换个视频试试 ~~~~")])]),s("div",{staticClass:"message-box"},[s("div",{staticClass:"message"},[s("div",{staticClass:"item-message"},[s("span",[t._v("分类:")]),s("div",[t._v(t._s(t.videoData.first_category_name))]),s("div",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.videoData.second_category_name))])]),s("div",{staticClass:"item-message",staticStyle:{display:"flex"}},[s("span",[t._v("关键词:")]),s("div",t._l(t.videoData.keyword_detail,(function(e,a){return s("div",{key:a,staticClass:"item-keywords",on:{click:function(s){return t.toCurrentTime(e)}}},[s("div",[t._v(t._s(e.keyword))])])})),0)]),s("div",{staticClass:"item-message"},[s("span",[t._v("播出时间:")]),s("div",[t._v(t._s(t.videoData.broadcast_time))])]),s("div",{staticClass:"item-message"},[s("span",[t._v("编辑提交时间:")]),s("div",[t._v(t._s(t.created_at))])]),s("div",{staticClass:"item-message",staticStyle:{"flex-wrap":"wrap"}},[s("span",[t._v("推送成功时间:")]),s("div",t._l(t.push_customers,(function(e,a){return s("div",{key:a,staticClass:"push-time"},["推送成功"===e.push_status?s("div",[t._v(" "+t._s(e.customer_name)+":"+t._s(e.push_success_at)+" ")]):t._e()])})),0)]),s("div",{staticClass:"item-message"},[s("span",[t._v("来源:")]),s("div",[t._v(" "+t._s(t.videoData.channel_name)+" "+t._s(t.videoData.item_name)+" ")])])]),s("div",{staticClass:"cover-box"},[t.videoData.cover_url?s("img",{attrs:{src:t.videoData.cover_url,alt:""}}):t._e()])])])])}),l=[],o={name:"",components:{},data:function(){return{show:!1,videoData:{},created_at:"",push_customers:[],dialogsObj:{width:"800px",title:"",center:!0}}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{toCurrentTime:function(t){this.$refs.video.currentTime=t.start_time/1e3},getData:function(t){var e=this;this.$get("/production/play-video?video_id="+t).then((function(t){console.log(t),e.videoData=t.data})).catch((function(t){e.$message({showClose:!0,message:"操作失败",type:"error"})}))},open:function(t){this.show=!0,this.getData(t)},clear:function(){this.$refs.video.pause(),this.created_at="",this.push_customers=[],this.videoData={},this.$emit("close")},close:function(){this.show=!1,this.clear()}}},c=o,r=(s("c8a4"),s("4ac2")),u=Object(r["a"])(c,n,l,!1,null,"4f9cfd75",null),d=u.exports,v=s("3c31"),p={components:{playVideo:d,clientStatus:v["a"]},data:function(){return{form:{status:"",send:""},total:null,page:1,limit:10,task_ids:[],send_options:[{label:"全部",value:""},{label:"待推送",value:"待推送"},{label:"推送成功",value:"推送成功"},{label:"推送失败",value:"推送失败"}],status_options:[{label:"全部",value:""},{label:"已提交",value:"已提交"},{label:"转码中",value:"转码中"},{label:"转码成功",value:"转码成功"},{label:"转码失败",value:"转码失败"}],tableData:[]}},computed:{clientStatus:function(){return this.$refs.clientStatus.list},task_id:function(){return this.$route.query.task_id}},watch:{},created:function(){this.getList()},mounted:function(){},methods:{resetSend:function(t,e){var s=this;if(e){var a={task_video_push_customer_id:t.push_customer_id};this.$post("production/push-again",a).then((function(e){s.$message({showClose:!0,message:"推送成功",type:"success"}),t.visible=!1})).catch((function(t){s.$message({showClose:!0,message:"推送失败",type:"error"})}))}else this.$message("推送开关已关闭")},setcustomersData:function(){var t=this;this.$nextTick((function(){t.tableData.forEach((function(t,e){var s=t.push_customers;s.forEach((function(t,e){t.visible=!1}))}))}))},handleCurrentChange:function(t){this.page=t,this.getList()},handleSizeChange:function(t){this.limit=t,this.getList()},getList:function(){var t=this,e={page:this.page,limit:this.limit,status:this.form.status,send:this.form.send,title:this.form.title,task_id:this.task_id};this.$get("/task/video-list-by-task-id",e).then((function(e){var s=e.data.list;t.tableData=s,t.tableData.forEach((function(t,e){"是"===t.can_push?t.isPush=!0:t.isPush=!1}));var a=e.data.total;t.total=a})).catch((function(e){t.$message.error(e.msg)}))},search:function(){this.page=1,this.getList()},playVideo:function(t){this.$refs.playVideo.push_customers=t.row.push_customers,this.$refs.playVideo.created_at=t.row.created_at,this.$refs.playVideo.open(t.row.video_id)},currentChange:function(t){this.page=t,this.getList()},changeSwitch:function(t,e){var s=this,a=JSON.parse(JSON.stringify(e.row));this.$nextTick((function(){a.isPush=t,s.$set(s.tableData,e.$index,a)}));var i={video_id:e.row.video_id,can_push:t?"是":"否"};this.$post("/task/video-can-push",i).then((function(t){console.log(t),s.$message({type:"success",message:t.msg})})).catch((function(i){s.$message(i.msg),s.$nextTick((function(){a.isPush=!t,s.$set(s.tableData,e.$index,a)}))}))},deatils:function(t){}}},h=p,m=(s("4290"),Object(r["a"])(h,a,i,!1,null,"7d26d041",null));e["default"]=m.exports},"922f":function(t,e,s){},9487:function(t,e,s){"use strict";s("922f")},bd0e:function(t,e,s){},c8a4:function(t,e,s){"use strict";s("516c")}}]);