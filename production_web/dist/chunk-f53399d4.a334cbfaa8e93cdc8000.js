(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f53399d4"],{"03bd":function(e,t,i){},"0a22":function(e,t,i){"use strict";i("03bd")},"2d37":function(e,t,i){},5830:function(e,t,i){},"5cf6":function(e,t,i){"use strict";i("5830")},"641f":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"edit-system"},[i("div",{staticClass:"header"},[i("p",[i("span",{staticClass:"type"},[e._v("广告")]),e._v(e._s(this.$store.state.settings.loginTitle))]),i("p",[i("span",{staticClass:"type type-time"},[e._v("时效")]),i("span",[e._v(e._s(e.getTime(1e3*e.taskMessage.processing_efficiency_seconds)))])]),i("p",[e._v(e._s(e.taskMessage.channel_name)+"("+e._s(e.taskMessage.task_id)+")"+e._s(e.taskMessage.start_date_time)+" - "+e._s(e.taskMessage.end_date_time))]),i("base-btn",{staticClass:"out-btn",attrs:{type:"text"},on:{click:e.goOut}},[e._v("退出任务")])],1),e.loading?e._e():i("div",{staticClass:"edit-system-content"},[i("TaskKeyFrame",{staticClass:"task-frame",attrs:{"task-message":e.taskMessage.ad_files,"start-time":e.taskMessage.start_date_time,"end-time":e.taskMessage.end_date_time}}),i("EditSystemForm",{staticClass:"edit-system-form",attrs:{"task-message":e.taskMessage}})],1),e.showNoTaskModel?i("NpTaskModel",{attrs:{show:e.showNoTaskModel},on:{close:e.close}}):e._e()],1)},a=[],n=(i("e18c"),i("96db"),i("af86"),i("b4fb"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"video-content"},[i("video-player",{key:e.videoUrl,ref:"videoPlayer",staticClass:"vjs-custom-skin",staticStyle:{display:"none"},attrs:{options:e.playerOptions,playsinline:!0},on:{canplay:function(t){return e.onPlayerCanplay(t)},timeupdate:function(t){return e.onPlayerTimeupdate(t)},ended:function(t){return e.onPlayerEnded(t)}}}),i("div",{staticClass:"video-header"},[i("div",{staticClass:"before-task-keyframe"},[i("p",{staticClass:"play-btn"},[e.videoStatus.pre?i("i",{staticClass:" el-icon el-icon-video-pause",on:{click:function(t){return e.setCurrentVideo("pre")}}}):i("i",{staticClass:"el-icon el-icon-video-play",on:{click:function(t){return e.setCurrentVideo("pre")}}})]),e._l(e.firstFiveVideoImg,(function(t,s){return i("div",{key:s,staticClass:"before-img-list"},e._l(t.list,(function(t){return i("div",{key:t.id,staticClass:"before-img"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive(t.currentTime-6,"Start"),expression:"isActive(item.currentTime - 6,'Start')"}],staticClass:"mask"}),i("base-image",{class:t.currentTime-1===e.currentTime&&"pre"===e.currentVideo&&"active-img",style:e.imgMinStyle,attrs:{src:t.imgUrl},nativeOn:{click:function(i){return e.changeCurrentTime(t.currentTime-1)},dblclick:function(i){return e.setTime(t.currentTime-6,"Start")}}})],1)})),0)}))],2)]),i("div",{staticClass:"task-keyframe"},[e._m(0),i("p",{staticClass:"play-btn"},[e.videoStatus.current?i("i",{staticClass:"el-icon el-icon-video-pause",on:{click:function(t){return e.setCurrentVideo("current")}}}):i("i",{staticClass:"el-icon el-icon-video-play",on:{click:function(t){return e.setCurrentVideo("current")}}})]),i("div",{ref:"imgContent",staticClass:"img-content"},[i("div",{staticClass:"wrap"},[i("RecycleScroller",{staticClass:"scroller",attrs:{items:e.videoImg,"item-size":122},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.item;return[i("div",{staticClass:"video-img-list-content"},e._l(s.list,(function(t,s){return i("div",{key:s,class:[e.isActive(t.currentTime-1,"Start"),"img-wrap"]},[i("base-image",{class:t.currentTime-1===e.currentTime&&"current"===e.currentVideo&&"active-img",style:e.imgStyle,attrs:{src:t.imgUrl},nativeOn:{click:function(i){return e.changeCurrentTime(t.currentTime-1)},dblclick:function(i){return e.setTime(t.currentTime-1,"Start")}}}),i("i",{staticClass:"el-icon-zoom-in scale",on:{click:function(i){return i.stopPropagation(),e.dialogImage(t.imgUrl)}}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive(t.currentTime-1,"Start"),expression:"isActive(obj.currentTime - 1,'Start')"}],staticClass:"mask"})],1)})),0)]}}])})],1)]),e.lastFiveVideoImg.length?i("div",[e._m(1),i("div",{staticClass:"before-task-keyframe"},[i("p",{staticClass:"play-btn"},[e.videoStatus.suf?i("i",{staticClass:"el-icon el-icon-video-pause",on:{click:function(t){return e.setCurrentVideo("suf")}}}):i("i",{staticClass:"el-icon el-icon-video-play",on:{click:function(t){return e.setCurrentVideo("suf")}}})]),e._l(e.lastFiveVideoImg,(function(t,s){return i("div",{key:s,staticClass:"before-img-list"},e._l(t.list,(function(t){return i("div",{key:t.id,staticClass:"before-img"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive(t.currentTime,"End"),expression:"isActive(item.currentTime,'End')"}],staticClass:"mask"}),i("base-image",{class:t.currentTime-1===e.currentTime&&"suf"===e.currentVideo&&"active-img",style:e.imgMinStyle,attrs:{src:t.imgUrl},nativeOn:{click:function(i){return e.changeCurrentTime(t.currentTime-1)},dblclick:function(i){return e.setTime(t.currentTime,"End")}}})],1)})),0)}))],2)]):e._e()]),i("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("img",{staticStyle:{width:"100%",height:"auto"},attrs:{src:e.dialogImageUrl,alt:""}})])],1)}),r=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"title"},[i("span",[e._v("任务开始")]),i("hr")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"title"},[i("hr")])}],o=i("07a3"),c=i("99a5"),l=i("1c03"),u=(i("6a61"),i("08ba"),i("fe8a"),i("ea69"),i("e35a"),i("5e9f"),i("2ac2")),m=(i("9258"),i("e09b")),d=i("ba4f"),f=i.n(d),g=i("52c1");function h(){var e=document.createEvent("MouseEvent");e.initMouseEvent("click",!0,!0,window,0,202,302,1,1,!1,!1,!1,!1,0,null)}var p={components:{RecycleScroller:u["a"]},props:{taskMessage:{type:Object,default:function(){return{}}},startTime:{type:String,default:function(){return""}},endTime:{type:String,default:function(){return""}}},data:function(){return{videoImg:[],firstFiveVideoImg:[],lastFiveVideoImg:[],baseMs:1e3,baseStartTime:null,baseEndTime:null,videoUrl:"",fiveSecondsVideoUrl:"",videoDuration:0,playerOptions:{height:"360",autoplay:!0,muted:!1,language:"en",playbackRates:[.7,1,1.5,2],sources:[{type:"video/mp4",src:""}],poster:"https://surmon-china.github.io/vue-quill-editor/static/images/surmon-1.jpg"},dialogVisible:!1,dialogImageUrl:"",currentTime:0,videoStatus:{pre:!1,current:!0,suf:!1},loading:!0,start:"",end:"",time:null,selectedImg:[],imgMinStyle:{width:"140px",height:"80px"},imgStyle:{width:"210px",height:"120px"},timeArray:[],curVideoDuration:null,currentVideo:"current"}},computed:Object(l["a"])(Object(l["a"])({},Object(g["b"])(["sidebar"])),{},{player:function(){return this.$refs.videoPlayer.player}}),watch:{"sidebar.opened":{handler:function(e){var t=this;this.$nextTick((function(){t.setVideoList()}))},deep:!0},currentVideo:function(e){var t=this;Object.keys(this.videoStatus).forEach((function(e){t.videoStatus[e]=!1})),this.currentTime=0,this.videoStatus[e]=!0}},beforeDestroy:function(){window.removeEventListener("onresize",this.resizeHandler)},created:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$bus.$on("timeSlot",(function(t){e.start=t.start,e.end=t.end})),e.$bus.$on("resetTime",(function(){e.selectedImg=[]})),e.$bus.$on("saveTime",(function(){e.timeArray.unshift({startTime:e.start,endTime:e.end})})),e.$bus.$on("delete",(function(t){e.timeArray.splice(t,1)})),e.baseStartTime=new Date(e.startTime).getTime(),e.baseEndTime=new Date(e.endTime).getTime(),e.curVideoDuration=(new Date(e.endTime).getTime()-new Date(e.startTime).getTime())/1e3,t.next=9,e.setVideoList();case 9:e.playerOptions.sources[0].src=e.taskMessage.current_audio_url;case 10:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:window.addEventListener("resize",e.resizeHandler),e.togglePlay(),e.toggleSideBar(),e.setPlayStatus();case 4:case"end":return t.stop()}}),t)})))()},methods:{setPlayStatus:function(){h(),this.player.play();this.player.play();var e=document.querySelectorAll(".vjs-big-play-button")[0];e.click()},onPlayerCanplay:function(e){console.log("🚀 ~ file: TaskKeyFrame.vue ~ line 274 ~ onPlayerCanplay ~ e",e)},toggleSideBar:function(){this.$store.dispatch("app/closeSideBar",{withoutAnimation:!0})},onPlayerTimeupdate:function(e){this.currentTime=Math.floor(e.currentTime())},onPlayerEnded:function(e){this.videoStatus[this.currentVideo]=!1},resizeHandler:window.lodash.throttle((function(){this.setVideoList()}),1e3),setVideoList:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var i,s,a,n,r,c,l,u,d,f,g,h,p,v,b,_;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.taskMessage,s=i.current_image_url,a=i.pre_image_url,n=i.suf_image_url,t.next=3,Object(m["a"])(e.setImgList("videoImg",s,e.curVideoDuration));case 3:return r=t.sent,c=Object(o["a"])(r,2),l=c[0],u=c[1],e.videoImg=u,l&&alert(l),t.next=11,Object(m["a"])(e.setImgList("firstVideoImg",a,5));case 11:return d=t.sent,f=Object(o["a"])(d,2),g=f[0],h=f[1],e.firstFiveVideoImg=h,g&&alert(g),t.next=19,Object(m["a"])(e.setImgList("lastVideoImg",n,5));case 19:p=t.sent,v=Object(o["a"])(p,2),b=v[0],_=v[1],e.lastFiveVideoImg=_,b&&alert(b);case 25:case"end":return t.stop()}}),t)})))()},setImgList:function(e,t,i){var s=this;return new Promise((function(a,n){s.$nextTick((function(){var n=s.$refs.imgContent,r=n.clientWidth,o=Math.floor(r/parseInt(s.imgStyle.width)),c=[];if(t){for(var l=1;l<i+1;l++){var u=t.replace(/%d/g,l),m={currentTime:l,imgUrl:u,id:l+"img"+e};c.push(m)}c=f()(c,o);var d=[];c.forEach((function(e,t){d.push({id:"img_".concat(t),list:e})})),a(d)}}))}))},togglePlay:function(){var e=this;document.onkeydown=function(t){var i=window.event.keyCode,s=t.target.nodeName;if(32===i&&"INPUT"!==s){if(t.preventDefault(),!e.currentVideo)return e.currentVideo="current",void(e.playerOptions.sources[0].src=e.taskMessage.current_audio_url);e.$nextTick((function(){e.videoStatus[e.currentVideo]=!e.videoStatus[e.currentVideo],e.videoStatus[e.currentVideo]?e.player.play():e.player.pause()}))}}},changeCurrentTime:function(e){var t=this;clearTimeout(this.time),this.time=setTimeout((function(){t.currentTime=e,t.player.currentTime(e)}),300)},setTime:function(e,t){if(clearTimeout(this.time),!this.start||!this.end){for(var i=this.$data["base"+t+"Time"]+1e3*e,s=0;s<this.timeArray.length;s++){var a=new Date(this.timeArray[s].startTime).getTime(),n=new Date(this.timeArray[s].endTime).getTime();if(i>=a&&i<=n)return}this.selectedStatus(e),this.$bus.$emit("setTime",i)}},selectedStatus:function(e){this.selectedImg.length<1?this.selectedImg[0]=e:this.selectedImg[1]=e},selectAcitve:function(e){return 2===this.selectedImg.length?e>=this.selectedImg[0]&&e<=this.selectedImg[1]:1===this.selectedImg.length?e===this.selectedImg[0]:void 0},isActive:function(e,t){for(var i=e,s=new Date(this.start).getTime(),a=new Date(this.end).getTime(),n=this.$data["base"+t+"Time"]+1e3*i,r=0;r<this.timeArray.length;r++){var o=new Date(this.timeArray[r].startTime).getTime(),c=new Date(this.timeArray[r].endTime).getTime();if(n>=o&&n<=c)return!0}return s===n&&!a||(a&&a?n>=s&&n<=a:void 0)},dialogImage:function(e){this.dialogImageUrl=e,this.dialogVisible=!0},setCurrentVideo:function(e){var t=this;this.currentVideo=e,this.videoStatus[e]=!this.videoStatus[e],this.playerOptions.sources[0].src=this.taskMessage[e+"_audio_url"],this.videoUrl=this.taskMessage[e+"_audio_url"],this.$nextTick((function(){t.videoStatus[e]?t.player.play():t.player.pause()}))}}},v=p,b=(i("0a22"),i("4ac2")),_=Object(b["a"])(v,n,r,!1,null,"75071e3e",null),k=_.exports,y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ad-edit-form"},[i("el-form",{ref:"ruleForm",attrs:{inline:!0,rules:e.rules,model:e.form,"label-width":"90px"}},[i("el-form-item",{attrs:{label:"标题名称:",prop:"title"}},[i("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入标题名称",clearable:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"分类:",prop:"category"}},[i("el-checkbox-group",{model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}},e._l(e.cateData,(function(t){return i("el-checkbox",{key:t,attrs:{label:t,disabled:e.isDisabled(t)}})})),1)],1),i("el-form-item",{attrs:{label:"开始时间:",prop:"start_time"}},[i("el-input",{attrs:{size:"mini",clearable:""},model:{value:e.form.start_time,callback:function(t){e.$set(e.form,"start_time",t)},expression:"form.start_time"}})],1),i("el-form-item",{attrs:{label:"结束时间:",prop:"end_time"}},[i("el-input",{attrs:{size:"mini",clearable:""},model:{value:e.form.end_time,callback:function(t){e.$set(e.form,"end_time",t)},expression:"form.end_time"}})],1),i("el-form-item",{staticClass:"form-mark",attrs:{label:"备注:","label-width":"80px"}},[e._v(" "+e._s(e.form.mark||"无")+" ")]),this.$route.query.status?e._e():i("div",{staticClass:"form-btn"},[i("base-btn",{attrs:{size:"mini",type:"warning"},on:{click:e.resetData}},[e._v("重置")]),i("base-btn",{attrs:{size:"mini"},on:{click:e.saveData}},[e._v("保存")])],1)],1),i("div",{staticClass:"table-content"},[i("el-table",{attrs:{data:e.tableData}},[i("el-table-column",{attrs:{prop:"title",label:"标题","show-overflow-tooltip":"",width:"200"}}),i("el-table-column",{attrs:{label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("p",[e._v(e._s(t.row.start_time.split(" ")[1]))]),i("p",[e._v(e._s(t.row.end_time.split(" ")[1]))])]}}])}),this.$route.query.status?e._e():i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("base-btn",{attrs:{type:"text"},on:{click:function(i){return e.deleteData(t.$index)}}},[e._v("删除")])]}}],null,!1,831436510)})],1)],1),this.$route.query.status?e._e():i("div",{staticClass:"table-btn"},[i("base-btn",{attrs:{size:"mini",type:"danger"},on:{click:e.hangUp}},[e._v("挂起")]),i("base-btn",{attrs:{size:"mini"},on:{click:e.complete}},[e._v("完成")])],1),i("HangUpDialog",{ref:"HangUpDialog",attrs:{id:e.taskMessage.task_id}}),i("CompleteDialog",{ref:"CompleteDialog"})],1)},T=[],w=(i("0d7a"),i("9302"),i("b130"),i("90aa"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("base-dialog",{attrs:{show:e.show,title:"任务挂起说明"},on:{close:e.close}},[i("el-form",{attrs:{inline:!0,"label-position":"left"}},e._l(e.formData,(function(t){return i("div",{key:t.name},[i("el-checkbox",{attrs:{label:t.name},model:{value:t.isChecked,callback:function(i){e.$set(t,"isChecked",i)},expression:"item.isChecked"}}),i("el-form-item",{attrs:{"label-width":"90px"}},[i("el-input",{attrs:{type:"textarea"},model:{value:t.desc,callback:function(i){e.$set(t,"desc",i)},expression:"item.desc"}})],1)],1)})),0),i("div",{staticClass:"dialog-footer"},[i("base-btn",{attrs:{size:"mini"},on:{click:e.submit}},[e._v("确定")]),i("base-btn",{attrs:{size:"mini",type:"info"},on:{click:e.cancel}},[e._v("取消")])],1)],1)}),$=[],C=(i("513c"),i("053b"),i("dbb3"),{components:{},props:{id:{type:Number,default:function(){return null}}},data:function(){return{show:!1,formData:[{name:"播出不符",desc:"",isChecked:!1},{name:"音画不同步",desc:"",isChecked:!1},{name:"视频源花屏",desc:"",isChecked:!1},{name:"跳帧",desc:"",isChecked:!1},{name:"其他",desc:"",isChecked:!1}]}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{open:function(){this.show=!0},close:function(){this.show=!1},cancel:function(){this.close()},setDesc:function(){var e=[];return this.formData.forEach((function(t){t.isChecked&&e.push({name:t.name,desc:t.desc})})),e},checkData:function(){var e=this.formData.filter((function(e){return e.isChecked}));return!!e.length},submit:function(){var e=this;if(this.checkData()){var t={task_id:this.id,status:"挂起中",desc:this.setDesc()};this.$post("/production/setStatus",t).then((function(t){e.$message({type:"success",message:"挂起成功"}),e.close(),e.$router.push({path:"/advertisement/edit-task"})})).catch((function(t){e.$message(t.msg)}))}else this.$message("请选择挂起原因")}}}),S=C,D=(i("7dbb"),Object(b["a"])(S,w,$,!1,null,"8b25eff0",null)),M=D.exports,I=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("base-dialog",{attrs:{show:e.show,title:"完成任务",width:"320px"},on:{close:e.close}},[i("div",{staticClass:"dialog-btn"},[i("base-btn",{attrs:{size:"mini",type:"info"},on:{click:e.out}},[e._v("退出任务")]),i("base-btn",{attrs:{size:"mini"},on:{click:e.startNewTask}},[e._v("开始新任务")])],1)])},x=[],O={components:{},props:{},data:function(){return{show:!1}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{close:function(){this.show=!1},open:function(){this.show=!0},out:function(){this.$router.push({path:"/advertisement/edit-task"})},startNewTask:function(){this.$parent.$parent.getTaskId(),this.close()}}},V=O,j=(i("6e3e"),Object(b["a"])(V,I,x,!1,null,"1eb15f88",null)),E=j.exports,A=i("90cd"),N=i("ed08"),U={components:{HangUpDialog:M,CompleteDialog:E},props:{taskMessage:{type:Object,default:function(){return{}}}},data:function(){return{form:{title:"",category:[],start_time:"",end_time:"",mark:""},timeout:null,tableData:[],channel_id:null,cateData:[],tagList:[],rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],category:[{required:!0,message:"请选择分类",trigger:"change"}],start_time:[{required:!0,message:"请输入开始时间",trigger:"blur"}],end_time:[{required:!0,message:"请输入结束时间",trigger:"blur"}]},baseTime:null,titleList:[]}},computed:{},watch:{"form.start_time":function(e){var t={start:this.form.start_time,end:this.form.end_time};this.$bus.$emit("timeSlot",t)},"form.end_time":function(e){var t={start:this.form.start_time,end:this.form.end_time};this.$bus.$emit("timeSlot",t)}},created:function(){this.cateData=this.taskMessage.tags.split(","),this.form.mark=this.taskMessage.comment,this.taskMessage.epg_ad_list&&this.taskMessage.epg_ad_list.length>0&&this.taskMessage.epg_ad_list.forEach((function(e){e.start_time=Object(N["b"])(e.start_time),e.end_time=Object(N["b"])(e.end_time)})),this.tableData=this.taskMessage.epg_ad_list||[],this.channel_id=this.taskMessage.channel_id,this.baseTime=new Date(this.taskMessage.start_date_time).getTime()},mounted:function(){var e=this;this.$bus.$on("setTime",(function(t){var i=t,s=new Date(e.form.start_time).getTime()||0,a=new Date(e.form.end_time).getTime()||0,n=[s,a];n[0]?n[1]=i:n[0]=i,i<=s?e.$message("开始时间不能大于结束时间"):(e.form.start_time=Object(N["b"])(n[0]),e.form.end_time=Object(N["b"])(n[1]))}))},methods:{querySearchAsync:function(e,t){var i=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,i.getTitleList(e);case 2:a=s.sent,n=[],a.forEach((function(e){n.push({id:e.id,value:e.title})})),t(n);case 6:case"end":return s.stop()}}),s)})))()},getTitleList:function(e){var t=this,i={channel_id:this.taskMessage.channel_id,keyword:e};return new Promise((function(e,s){t.$get("/epg-ad/epg-ad-search",i).then((function(t){e(t.data.list)})).catch((function(e){t.$message(e.msg)}))}))},hangUp:function(){this.$refs.HangUpDialog.open()},complete:function(){var e=this,t={seqs:this.setSeqs(JSON.parse(JSON.stringify(this.tableData)))};this.$post("/epg-ad/".concat(this.taskMessage.task_id,"/seqs"),t).then((function(t){e.$message({type:"success",message:"提交成功"}),e.$refs.CompleteDialog.open()})).catch((function(t){e.$message(t.msg)}))},setSeqs:function(e){return e.forEach((function(e,t){e.start_time=new Date(e.start_time).getTime(),e.end_time=new Date(e.end_time).getTime(),e.type="广告"})),e},resetData:function(){this.form.title="",this.form.category=[],this.form.start_time="",this.form.end_time="",this.$bus.$emit("resetTime")},saveData:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;var i=new Date(e.form.start_time).getTime(),s=new Date(e.form.end_time).getTime();if(i>s)e.$message("开始时间不能大于结束时间");else{new Date(e.taskMessage.start_date_time).getTime();e.tableData.unshift({title:e.form.title,start_time:e.form.start_time,end_time:e.form.end_time,tags:e.form.category.join(",")}),e.$bus.$emit("saveTime"),e.resetData()}}))},deleteData:function(e){this.tableData.splice(e,1),this.$bus.$emit("delete",e)},isDisabled:function(e){return!("商业广告"!==e||!this.form.category.includes("公益广告"))||!("公益广告"!==e||!this.form.category.includes("商业广告"))}}},q=U,z=(i("badc"),Object(b["a"])(q,y,T,!1,null,null,null)),P=z.exports,F={components:{TaskKeyFrame:k,EditSystemForm:P,NpTaskModel:function(){return i.e("chunk-127e21a2").then(i.bind(null,"0a78"))}},props:{},data:function(){return{taskMessage:{},loading:!0,task_id:null,showNoTaskModel:!1}},computed:{},watch:{},created:function(){this.getInfo()},mounted:function(){},methods:{getInfo:function(){var e=this;this.loading=!0,this.task_id=this.task_id||this.$route.query.tid;var t=this.$route.query.status?"view":"edit";this.$get("/epg-ad/".concat(this.task_id,"/task-info/").concat(t)).then((function(t){e.taskMessage=t.data,e.loading=!1})).catch((function(t){console.log(t),e.$message(t.msg)}))},getTime:function(e){return Object(A["b"])(e)},goOut:function(){this.$router.go(-1)},close:function(){this.showNoTaskModel=!1},getTaskId:function(){var e=this;this.$get("/ads-task/get-task").then((function(t){e.task_id=t.data.id,e.$router.push({path:"/advertisement/edit-system",query:{tid:e.task_id}}),e.getInfo()})).catch((function(t){"暂时没有任务"!==t.msg?e.$message(t.msg):e.showNoTaskModel=!0}))}}},L=F,R=(i("5cf6"),Object(b["a"])(L,s,a,!1,null,"b48bbd10",null));t["default"]=R.exports},"6e3e":function(e,t,i){"use strict";i("8ecd")},"7dbb":function(e,t,i){"use strict";i("2d37")},"8ecd":function(e,t,i){},"90cd":function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return a}));i("e35a"),i("5e9f"),i("0d7a"),i("513c");function s(e){var t,i=parseInt(e%864e5/36e5),s=parseInt(e%36e5/6e4),a=e%6e4/1e3;return t=(i<10?"0"+i:i)+":"+(s<10?"0"+s:s)+":"+(a<10?"0"+a:a),t}function a(e){if(!isNaN(e))var t=new Date(e);var i=t.getFullYear(),s=t.getMonth()+1+"",a=t.getDate()+"";return s=s.replace(/\b\d\b/g,"0$&"),a=a.replace(/\b\d\b/g,"0$&"),i+"-"+s+"-"+a}},badc:function(e,t,i){"use strict";i("ebd3")},e09b:function(e,t,i){"use strict";function s(e){return e.then((function(e){return[null,e]})).catch((function(e){return[e]}))}t["a"]=s},ebd3:function(e,t,i){},ed08:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return r}));var s=i("01d6");i("e35a"),i("5e9f"),i("84c2"),i("1c2e"),i("e18c"),i("898e"),i("0d7a"),i("08ba");function a(e,t){if(0===arguments.length||!e)return null;var i,a=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(s["a"])(e)?i=e:("string"===typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),i=new Date(e));var n={y:i.getFullYear(),m:i.getMonth()+1,d:i.getDate(),h:i.getHours(),i:i.getMinutes(),s:i.getSeconds(),a:i.getDay()},r=a.replace(/{([ymdhisa])+}/g,(function(e,t){var i=n[t];return"a"===t?["日","一","二","三","四","五","六"][i]:i.toString().padStart(2,"0")}));return r}function n(e,t){if(0===arguments.length||!e)return null;var i,a=t||"{h}:{i}:{s}";"object"===Object(s["a"])(e)?i=e:("string"===typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),i=new Date(e));var n={h:i.getHours(),i:i.getMinutes(),s:i.getSeconds(),a:i.getDay()},r=a.replace(/{([hisa])+}/g,(function(e,t){var i=n[t];return"a"===t?["日","一","二","三","四","五","六"][i]:i.toString().padStart(2,"0")}));return r}function r(e){parseInt(e/864e5);var t=parseInt(e%864e5/36e5),i=parseInt(e%36e5/6e4),s=parseInt(e%6e4/1e3),a=parseInt(e-36e5*t-6e4*i-1e3*s);return{hours:t,minutes:i,seconds:s,ms:a}}}}]);