(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e05f072"],{3703:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"trackHeader"},[a("ul",{staticClass:"btn-list"},[a("li",[a("a",{on:{click:function(e){return t.addCutTrak()}}},[a("i",{staticClass:"iconfont icon-ziyuan"})])]),a("li",[a("a",{on:{click:function(e){return t.addDecorate()}}},[a("i",{staticClass:"iconfont icon-masaike1"})])]),a("li",[a("a",{on:{click:function(e){return t.deleteDecorate()}}},[a("i",{staticClass:"iconfont icon-shanchu"})])]),a("li",{staticClass:"track-btn-ul"},[a("span",{staticClass:"text",on:{click:function(t){t.stopPropagation()}}},[t._v("设置秒数")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.track_s,expression:"track_s"}],attrs:{type:"number",min:"0"},domProps:{value:t.track_s},on:{input:function(e){e.target.composing||(t.track_s=e.target.value)}}}),a("a",{staticClass:"text",on:{click:function(e){return e.stopPropagation(),t.setMaxMs()}}},[t._v("max")]),a("a",{staticClass:"text",on:{click:function(e){return e.stopPropagation(),t.setMs()}}},[t._v("确认")])]),a("li",{staticClass:"export-btn"},[a("div",{on:{click:function(e){return t.exportVideo()}}},[t._v("导出视频")])])])])},s=[],c=(a("fc2a"),a("6afd"),a("0ce9")),r=a("3532"),n={props:{},data:function(){return{track_s:0}},mixins:[c["a"]],computed:{PER_PX_MS:function(){return this.$store.state.PER_PX_MS},duration:function(){return this.$store.state.videoPlay.duration},decorate_active_id:function(){return this.$store.state.decorate_active_id},active_track:function(){var t=this,e=this.$store.state.decorate_list;return e.find((function(e){return e.id==t.decorate_active_id}))},cutDetails:function(){return this.$store.state.cut_details}},watch:{},methods:{addCutTrakOfMobile:function(){parseInt(this.$store.state.videoPlay.current_time_ms),parseInt(this.$store.state.PER_PX_MS);var t=document.getElementById("videoCanvas"),e=this.$store.state.decorate_list,a=this.duration/this.PER_PX_MS;if(!e.some((function(t){return"裁剪"==t.type}))){var i=t.height,s=i*(9/16),c=t.width/2-s/2,n={x:c,y:0,w:s,h:i,id:"decorate_"+Object(r["a"])(),active:!0,type:"裁剪",trackLeft:0,resizable:!1,trackWidth:a};this.addTrackData(n)}},activeBtnList:function(t){var e=this;if("setMosaicList"==t.data.cmd){var a=t.data.data,i=document.getElementById("videoCanvas"),s=i.width,c=i.height,n=document.getElementById("myVideo"),o=n.videoWidth,d=n.videoHeight;a.forEach((function(t){var a=t.y/d*c,i=t.x/o*s,n=t.width/o*s,u=t.height/d*c,h={active:!1,w:n,x:i,y:a,h:u,id:"decorate_"+Object(r["a"])(),trackLeft:t.start_ms/e.PER_PX_MS,trackWidth:(t.end_ms-t.start_ms)/e.PER_PX_MS,type:t.type||"马赛克"};e.addTrackData(h)}))}},setMs:function(){if(this.active_track){var t=this.duration/this.PER_PX_MS,e=1e3*this.track_s/this.PER_PX_MS,a=Math.min(t,e);this.setTrackData({trackWidth:a},this.decorate_active_id)}},setMaxMs:function(){if(this.active_track){var t=this.duration/this.PER_PX_MS,e=t-this.active_track.trackLeft;this.setTrackData({trackWidth:e},this.decorate_active_id)}},addDecorate:function(){var t=parseInt(this.$store.state.videoPlay.current_time_ms),e=parseInt(this.$store.state.PER_PX_MS),a={x:10,y:10,w:100,h:50,id:"decorate_"+Object(r["a"])(),active:!1,type:"马赛克",trackLeft:(t-e)/e,trackWidth:100};this.addTrackData(a)},addCutTrak:function(){var t=this.$store.state.decorate_list,e=this.duration/this.PER_PX_MS;if(!t.some((function(t){return"裁剪"==t.type}))){var a={x:10,y:10,w:400,h:300,id:"decorate_"+Object(r["a"])(),active:!0,type:"裁剪",trackLeft:0,trackWidth:e};this.addTrackData(a)}},exportVideo:function(){var t=this.$store.state.decorate_list,e=[],a=this.$store.state.PER_PX_MS,i=document.getElementById("myVideo"),s=i.videoWidth,c=i.videoHeight,r=document.getElementById("videoCanvas"),n=r.width,o=r.height;t.forEach((function(t){var i=t.y/o*c,r=t.x/n*s,d=t.w/n*s,u=t.h/o*c,h=t.trackLeft*a,_={start_ms:h<500?0:h,end_ms:(t.trackLeft+t.trackWidth)*a,y:i,x:r,width:d,height:u,type:t.type};e.push(_)})),window.parent.postMessage({cmd:"exportArr",data:e},"*");var d=this.exportcutDetails(),u={width:s,height:c};window.parent.postMessage({cmd:"exportAllData",data:{cutDetails:d,decorateList:e,videoSize:u}},"*")},exportcutDetails:function(){var t=this.cutDetails.trackLeft*this.PER_PX_MS,e=(this.cutDetails.trackLeft+this.cutDetails.trackWidth)*this.PER_PX_MS,a={start_ms:t<500?0:t,end_ms:this.duration-e<500?this.duration:e};return a},deleteDecorate:function(){this.deleteTrackData(this.$store.state.decorate_active_id)}},components:{},created:function(){},mounted:function(){window.addEventListener("message",this.activeBtnList,!1)}},o=n,d=(a("4b12"),a("4ac2")),u=Object(d["a"])(o,i,s,!1,null,"3dd67674",null);e["default"]=u.exports},"4b12":function(t,e,a){"use strict";a("de4d")},de4d:function(t,e,a){}}]);
//# sourceMappingURL=chunk-6e05f072.e816392b.js.map