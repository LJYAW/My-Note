(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16e56eff"],{4086:function(t,e,a){},"911c":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-met"},[a("div",{staticClass:"search-top"},[a("div",[a("div",{staticClass:"search-list"},[a("div",{staticClass:"item-serach"},[a("span",{staticClass:"item-label"},[t._v("频道:")]),a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择频道"},model:{value:t.form.channel_id,callback:function(e){t.$set(t.form,"channel_id",e)},expression:"form.channel_id"}},t._l(t.channelData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("div",{staticClass:"item-serach"},[a("span",{staticClass:"item-label"},[t._v("播出日期:")]),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",clearable:!1},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),a("div",{staticClass:"item-serach"},[a("span",{staticClass:"item-label"},[t._v("状态:")]),a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.status_options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("div",{staticClass:"item-serach btns"},[a("base-btn",{attrs:{size:"big"},on:{click:function(e){return t.search()}}},[t._v("搜索")])],1)])])]),a("div",{staticStyle:{"margin-top":"36px"}},[a("el-table",{staticClass:"table-list",attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{prop:"task_id",label:"TID"}}),a("el-table-column",{attrs:{prop:"channel_name",label:"频道"}}),a("el-table-column",{attrs:{prop:"start_time",label:"任务时间段"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.start_time))]),a("span",[t._v("-")]),a("span",[t._v(t._s(e.row.end_time))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"任务状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["挂起中"==e.row.status?a("div",[a("span",[t._v(t._s(e.row.status))]),a("el-tooltip",{staticClass:"item tooltip-item",attrs:{effect:"light",placement:"top"}},[a("a",{staticClass:"el-icon-warning warning-icon"}),a("div",{attrs:{slot:"content"},slot:"content"},t._l(e.row.hang_up_reason,(function(e,s){return a("div",{key:s},[a("div",[t._v(t._s(s+1)+". "+t._s(e.name))]),a("div",[t._v(t._s(e.desc))])])})),0)])],1):a("span",[t._v(t._s(e.row.status))])]}}])}),a("el-table-column",{attrs:{prop:"department",label:"团队"}}),a("el-table-column",{attrs:{prop:"executor",label:"执行人"}}),a("el-table-column",{attrs:{prop:"updated_at",label:"更新时间"}}),a("el-table-column",{attrs:{prop:"",label:"操作",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.$store.state.user.userInfo.is_superman?a("div",["挂起中"===e.row.status||"已关闭"===e.row.status?a("base-btn",{attrs:{type:"text"},on:{click:function(a){return t.startTask(e)}}},[t._v("开启任务")]):a("base-btn",{staticClass:"end-task",attrs:{type:"text"}},["已完成"!==e.row.status?a("span",{on:{click:function(a){return t.resetTask(e)}}},[t._v("关闭任务")]):t._e()])],1):t._e()]}}])})],1)],1),a("div",{staticClass:"pagination-list"},[a("base-pag",{attrs:{total:t.total,limit:t.limit,page:t.page},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)])},l=[],n=a("1c03"),i=a("52c1"),r=a("a59a"),o={components:{},data:function(){return{form:{channel_id:null,date:Object(r["a"])(new Date),status:""},status_options:[{label:"全部",value:""},{label:"挂起中",value:"挂起中"},{label:"已完成",value:"已完成"},{label:"进行中",value:"进行中"},{label:"待分配",value:"待分配"},{label:"等待中",value:"等待中"},{label:"已关闭",value:"已关闭"}],tableData:[],limit:10,total:null,page:1}},computed:Object(n["a"])({},Object(i["b"])(["channelData"])),watch:{},created:function(){this.$store.dispatch("channel/getChannelData"),this.getList()},mounted:function(){},methods:{search:function(){this.page=1,this.getList()},getList:function(){var t=this,e={channel_id:this.form.channel_id||null,date:this.form.date,status:this.form.status||null,page:this.page,limit:this.limit};this.$get("/epg-task/epg-task-list",e).then((function(e){t.tableData=e.data.list,t.total=e.data.total})).catch((function(e){t.$message.error(e.msg)}))},upsStatus:function(t,e){var a=this,s={id:t,status:e};this.$post("/epg-task/up-status",s).then((function(t){a.$message({showClose:!0,message:1===e?"开启任务成功":"释放任务成功",type:"success"}),a.getList()})).catch((function(t){a.$message({showClose:!0,message:1===e?"开启任务失败":"释放任务失败",type:"error"})}))},startTask:window.lodash.throttle((function(t){this.upsStatus(t.row.task_id,1)}),2e3),resetTask:window.lodash.throttle((function(t){this.upsStatus(t.row.task_id,-1)}),2e3),handleCurrentChange:function(t){this.page=t,this.getList()},handleSizeChange:function(t){this.limit=t,this.getList()}}},c=o,u=(a("b04e"),a("4ac2")),d=Object(u["a"])(c,s,l,!1,null,"49d8cfde",null);e["default"]=d.exports},a59a:function(t,e,a){"use strict";a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return l})),a.d(e,"b",(function(){return n}));a("e35a"),a("5e9f"),a("0d7a"),a("513c");function s(t){var e,a=parseInt(t%864e5/36e5),s=parseInt(t%36e5/6e4),l=t%6e4/1e3;return e=(a<10?"0"+a:a)+":"+(s<10?"0"+s:s)+":"+(l<10?"0"+l:l),e}function l(t){if(!isNaN(t))var e=new Date(t);var a=e.getFullYear(),s=e.getMonth()+1+"",l=e.getDate()+"";return s=s.replace(/\b\d\b/g,"0$&"),l=l.replace(/\b\d\b/g,"0$&"),a+"-"+s+"-"+l}function n(t){var e=t.split(":"),a=36e5*Number(e[0]),s=6e4*Number(e[1]),l=1e3*Number(e[2]);return Math.floor((a+s+l)/60)}},b04e:function(t,e,a){"use strict";a("4086")}}]);