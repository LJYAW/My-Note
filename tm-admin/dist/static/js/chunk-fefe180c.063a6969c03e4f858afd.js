(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fefe180c"],{"0115":function(e,t,a){var n=a("ee2d");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("499e").default;r("2151d89b",n,!0,{sourceMap:!1,shadowMode:!1})},"0652":function(e,t,a){var n=a("07dd");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("499e").default;r("9bcba2b6",n,!0,{sourceMap:!1,shadowMode:!1})},"07dd":function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,".task-table .total[data-v-4f80618d]{margin-bottom:20px}.task-table .el-button+.el-button[data-v-4f80618d]{margin-left:0}.task-table .el-button--text[data-v-4f80618d]{margin-right:5px}",""]),e.exports=t},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},3145:function(e,t,a){"use strict";a("0652")},"3c54":function(e,t,a){var n=a("e43e");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("499e").default;r("2a26a9f6",n,!0,{sourceMap:!1,shadowMode:!1})},5505:function(e,t,a){"use strict";a("0115")},"841c":function(e,t,a){"use strict";var n=a("d784"),r=a("825a"),s=a("1d80"),o=a("129f"),i=a("14c3");n("search",1,(function(e,t,a){return[function(t){var a=s(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,a):new RegExp(t)[e](String(a))},function(e){var n=a(t,e,this);if(n.done)return n.value;var s=r(e),l=String(this),c=s.lastIndex;o(c,0)||(s.lastIndex=0);var u=i(s,l);return o(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]}))},"9b31":function(e,t,a){"use strict";a("dd64")},c60b:function(e,t,a){"use strict";a("99af"),a("5319"),a("ac1f");t["a"]=function(e){var t="";for(var a in e)(e[a]||"0"===e[a])&&(t+="".concat(a,":").concat(e[a],","));return t.replace(/,$/gi,"")}},dd64:function(e,t,a){var n=a("ddde");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("499e").default;r("6ef7d3d3",n,!0,{sourceMap:!1,shadowMode:!1})},ddde:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,".btn-wrap[data-v-3da5a43c]{margin-top:40px;text-align:center}",""]),e.exports=t},e43e:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,".task-mgt[data-v-10255bd4]{padding:20px}.task-mgt .search-wrap[data-v-10255bd4]{display:flex;justify-content:space-between}.task-mgt .search-wrap .el-form-item[data-v-10255bd4]{margin-right:20px}.task-mgt .search-wrap .btn-item[data-v-10255bd4],.task-mgt .search-wrap .btn-item[data-v-10255bd4]  .el-form-item__content{width:100%}.task-mgt .search-wrap .btn-item[data-v-10255bd4]  .el-form-item__content .add-btn{float:right}",""]),e.exports=t},ee2d:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,".analysis-dialog .el-form[data-v-e872f6ee]{height:60vh;overflow-y:auto}.analysis-dialog .el-form .el-select[data-v-e872f6ee]{width:100%}.analysis-dialog .el-form .contenteditable-wrap[data-v-e872f6ee]{width:100%;height:80px;border:1px solid #bbb;margin-top:10px;padding:10px}.analysis-dialog .btn-wrap[data-v-e872f6ee]{margin-top:20px;text-align:center}",""]),e.exports=t},f015:function(e,t,a){"use strict";a("3c54")},fa3d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"task-mgt"},[a("div",{staticClass:"search-wrap"},[a("el-form",{attrs:{inline:!0,"label-width":"70px","label-position":"left",model:e.form}},[a("el-form-item",{attrs:{label:"频道名称"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择频道"},model:{value:e.form.channel_id,callback:function(t){e.$set(e.form,"channel_id",t)},expression:"form.channel_id"}},e._l(e.channelData,(function(e){return a("el-option",{key:e.channel_uuid,attrs:{value:e.channel_uuid,label:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"栏目名称"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择栏目"},model:{value:e.form.program_id,callback:function(t){e.$set(e.form,"program_id",t)},expression:"form.program_id"}},e._l(e.itemData,(function(e){return a("el-option",{key:e.item_uuid,attrs:{value:e.item_uuid,label:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"路径来源"}},[a("el-input",{attrs:{placeholder:"请输入路径来源"},model:{value:e.form.source,callback:function(t){e.$set(e.form,"source",t)},expression:"form.source"}})],1),a("el-form-item",{attrs:{label:"任务状态"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择任务状态"},model:{value:e.form.doType,callback:function(t){e.$set(e.form,"doType",t)},expression:"form.doType"}},e._l(e.baseData.statusData,(function(e,t){return a("el-option",{key:t,attrs:{value:t,label:e}})})),1)],1),a("el-form-item",{attrs:{label:"资源类型"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择资源类型"},model:{value:e.form.resourcetype,callback:function(t){e.$set(e.form,"resourcetype",t)},expression:"form.resourcetype"}},e._l(e.baseData.typeData,(function(e,t){return a("el-option",{key:e,attrs:{value:t+1,label:e}})})),1)],1),a("el-form-item",{attrs:{label:"业务"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择任务业务"},model:{value:e.form.business,callback:function(t){e.$set(e.form,"business",t)},expression:"form.business"}},e._l(e.baseData.workData,(function(e){return a("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1),a("el-form-item",{staticClass:"btn-item"},[a("base-btn",{on:{click:e.search}},[e._v("查询")]),a("base-btn",{on:{click:e.clearSearch}},[e._v("清除")]),a("base-btn",{on:{click:e.exportData}},[e._v("导出")]),a("base-btn",{directives:[{name:"has",rawName:"v-has",value:["superman","任务管理"],expression:"['superman','任务管理']"}],staticClass:"add-btn",on:{click:e.addTask}},[e._v("新增任务")])],1)],1)],1),a("taskTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"task-data":e.taskData,pag:e.pag},on:{currentChange:e.handleCurrentChange,sizeChange:e.handleSizeChange,updateData:e.getTaskList}})],1)},r=[],s=a("1da1"),o=a("5530"),i=(a("96cf"),a("4de4"),a("2b3d"),a("d3b7"),a("3ca3"),a("ddb0"),a("841c"),a("ac1f"),a("2f62")),l=a("fcd9"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"task-table"},[a("p",{staticClass:"total"},[e._v("当前条件下共"+e._s(e.pag.total)+"条数据")]),a("el-table",{attrs:{data:e.taskData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID"}}),a("el-table-column",{attrs:{prop:"resourcetype",label:"资源类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.resourcetype[t.row.resourcetype-1])+" ")]}}])}),a("el-table-column",{attrs:{prop:"channel_name",label:"频道名称",width:"300"}}),a("el-table-column",{attrs:{prop:"program_name",label:"栏目名称",width:"200"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.baseData.statusData[t.row.doType])+" ")]}}])}),a("el-table-column",{attrs:{prop:"source",label:"路径来源"}}),a("el-table-column",{attrs:{prop:"business",label:"业务",width:"180"}}),a("el-table-column",{attrs:{prop:"restrict",label:"数据限制",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.programTimeStart)+" - "+e._s(t.row.programTimeEnd)+" ")]}}])}),a("el-table-column",{attrs:{prop:"successnums",label:"成功数"}}),a("el-table-column",{attrs:{prop:"lastfinishtime",label:"爬取时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.lastfinishtime?a("span",[e._v(" "+e._s(e._f("unixToHms")(1e3*t.row.lastfinishtime))+" ")]):a("span",[e._v(" - ")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("base-btn",{directives:[{name:"has",rawName:"v-has",value:["superman","任务管理"],expression:"['superman','任务管理']"}],attrs:{type:"text"},on:{click:function(a){return e.edit(t.row.id)}}},[e._v("编辑")]),-3!==t.row.doType&&-4!==t.row.doType&&-5!==t.row.doType?a("base-btn",{directives:[{name:"has",rawName:"v-has",value:["superman","任务管理","任务删除"],expression:"['superman','任务管理','任务删除']"}],attrs:{type:"text"},on:{click:function(a){return e.confirm("取消任务",-4,t.row.id)}}},[e._v("取消任务")]):e._e(),-2==t.row.doType?a("base-btn",{attrs:{type:"text"},on:{click:function(a){return e.changeStatus("无法解析",-3,t.row.id)}}},[e._v("无法解析")]):e._e(),2==t.row.doType&&1==t.row.resourcetype?a("base-btn",{attrs:{type:"text"},on:{click:function(a){return e.confirm("标记完结",3,t.row.id)}}},[e._v("标记完结")]):e._e(),3==t.row.doType&&1==t.row.resourcetype?a("base-btn",{attrs:{type:"text"},on:{click:function(a){return e.confirm("标记在播",2,t.row.id)}}},[e._v("标记在播")]):e._e(),-4==t.row.doType?a("base-btn",{attrs:{type:"text"},on:{click:function(a){return e.changeStatus("开启爬取",2,t.row.id)}}},[e._v("开启爬取")]):e._e(),a("base-btn",{attrs:{type:"text"},on:{click:function(a){return e.work(t.row.id)}}},[e._v("执行")])]}}])})],1),a("base-pag",{attrs:{total:e.pag.total,limit:e.pag.pageSize,page:e.pag.currentPage},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),a("base-dialog",{attrs:{show:e.dialogVisible,title:e.dialogTitle},on:{"update:show":function(t){e.dialogVisible=t}}},[a(e.dialogCompomtentsName,{tag:"compontents",attrs:{title:e.dialogTitle},on:{close:e.close,updateData:e.updateData}})],1)],1)},u=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-input",{attrs:{placeholder:"请输入您的姓名"},model:{value:e.person,callback:function(t){e.person=t},expression:"person"}}),a("div",{staticClass:"btn-wrap"},[a("base-btn",{on:{click:e.submit}},[e._v("确定")]),a("base-btn",{attrs:{type:"info"},on:{click:e.cancel}},[e._v("取消")])],1)],1)},p=[],m={components:{},props:{show:{type:Boolean,default:!1}},data:function(){return{person:""}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{close:function(){this.$emit("close")},cancel:function(){this.close()},submit:function(){this.$emit("updateData"),this.close()}}},f=m,b=(a("9b31"),a("2877")),h=Object(b["a"])(f,d,p,!1,null,"3da5a43c",null),g=h.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"analysis-dialog"},[a("el-form",{attrs:{model:e.form,"label-width":"90px","label-position":"left"}},[a("el-form-item",{attrs:{label:"视频名称",prop:"videoName"}},[a("el-select",{attrs:{placeholder:"请选择页面",size:"mini"},model:{value:e.form.videoName,callback:function(t){e.$set(e.form,"videoName",t)},expression:"form.videoName"}},e._l(e.videoType,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-form-item",{attrs:{prop:"videoName"}},[a("div",{staticClass:"contenteditable-wrap",attrs:{contenteditable:"true"}})])],1),a("el-form-item",{attrs:{label:"开播时间",prop:"startTime"}},[a("el-select",{attrs:{placeholder:"请选择页面",size:"mini"},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}},e._l(e.videoType,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-form-item",[a("div",{staticClass:"contenteditable-wrap",attrs:{contenteditable:"true"}})])],1),a("el-form-item",{attrs:{label:"集/期数",prop:"num"}},[a("el-select",{attrs:{placeholder:"请选择页面",size:"mini"},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}},e._l(e.videoType,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-form-item",[a("div",{staticClass:"contenteditable-wrap",attrs:{contenteditable:"true"}})])],1),a("el-form-item",{attrs:{label:"视频介绍",prop:"desc"}},[a("el-select",{attrs:{placeholder:"请选择页面",size:"mini"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}},e._l(e.videoType,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-form-item",[a("div",{staticClass:"contenteditable-wrap",attrs:{contenteditable:"true"}})])],1),a("el-form-item",{attrs:{label:"封面图",prop:"banner"}},[a("el-select",{attrs:{placeholder:"请选择页面",size:"mini"},model:{value:e.form.banner,callback:function(t){e.$set(e.form,"banner",t)},expression:"form.banner"}},e._l(e.videoType,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1),a("el-form-item",[a("div",{staticClass:"contenteditable-wrap",attrs:{contenteditable:"true"}})])],1)],1),"解析字段"===e.title?a("div",{staticClass:"btn-wrap"},[a("base-btn",[e._v("确定")]),a("base-btn",{attrs:{type:"info"}},[e._v("取消")])],1):e._e()],1)},w=[],_={components:{},props:{title:{type:String,default:function(){return""}}},data:function(){return{form:{videoName:"",startTime:"",num:"",desc:"",banner:""},videoType:["列表","播放"]}},computed:{},watch:{},created:function(){"查看解析字段"===this.title&&this.getDialogData()},mounted:function(){},methods:{getDialogData:function(){console.log("获取查看解析字段数据")}}},y=_,k=(a("5505"),Object(b["a"])(y,v,w,!1,null,"e872f6ee",null)),x=k.exports,T={components:{addAnalyzerDialog:g,analysisDialog:x},props:{taskData:{type:Array,default:function(){return[]}},pag:{type:Object,default:function(){return{}}}},data:function(){return{dialogTitle:"",dialogVisible:!1,dialogCompomtentsName:"",baseData:l["a"],resourcetype:["整档","单集","短视频"],roles:localStorage.getItem("roles")}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{handleCurrentChange:function(e){this.$emit("currentChange",e)},handleSizeChange:function(e){this.$emit("sizeChange",e)},close:function(){this.dialogVisible=!1},openDialog:function(e,t){this.dialogVisible=!0,this.dialogCompomtentsName=t,this.dialogTitle=e},updateData:function(){this.$emit("updateData")},edit:function(e){this.$router.push({path:"/editTask",query:{id:e}})},confirm:function(e,t,a){var n=this;this.$confirm("确定".concat(e,"？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.changeStatus(e,t,a)})).catch((function(){n.$message({type:"info",message:"已取消删除"})}))},changeStatus:function(e,t,a){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.$put("/jobs/".concat(a),{doType:t});case 2:s=r.sent,s.data,o=s.err,o?n.$message.error(o.msg):(n.$message({type:"success",message:"".concat(e,"成功")}),n.updateData());case 6:case"end":return r.stop()}}),r)})))()},deleteTask:function(e){var t=this;this.$confirm("确定取消任务？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.delete(e)})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},delete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$deleteRun("/jobs/".concat(e));case 2:n=a.sent,n.data,r=n.err,r?t.$message.error(r.msg):(t.$message({type:"success",message:"取消任务成功"}),t.updateData());case 6:case"end":return a.stop()}}),a)})))()},work:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$get("/jobs/sendjobs?id=".concat(e));case 2:n=a.sent,n.data,r=n.err,r?t.$message.error(r.msg):t.$message({type:"success",message:"执行成功"});case 6:case"end":return a.stop()}}),a)})))()}}},D=T,$=(a("3145"),Object(b["a"])(D,c,u,!1,null,"4f80618d",null)),C=$.exports,S=a("c60b"),j=a("28de"),z={name:"Task",components:{taskTable:C},props:{},data:function(){return{form:{channel_id:null,program_id:null,source:"",doType:null,resourcetype:null,business:null},loading:!0,itemData:[],baseData:l["a"],taskData:[],pag:{currentPage:1,pageSize:10,total:0},roles:localStorage.getItem("roles")}},computed:Object(o["a"])({},Object(i["b"])(["channelData"])),watch:{"form.channel_id":function(e){e&&this.getItemList(),this.form.program_id=null}},created:function(){!this.channelData.length&&this.$store.dispatch("channel/getChannelData"),this.getTaskList()},mounted:function(){},methods:{getItemList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.channelData.filter((function(t){return t.channel_uuid===e.form.channel_id}))[0].channel_id,n={channel_id:a},t.next=4,e.$get("/jobs/programs",n);case 4:if(r=t.sent,s=r.data,o=r.err,!o){t.next=10;break}return e.$message.error(o.msg),t.abrupt("return");case 10:e.itemData=s.data;case 11:case"end":return t.stop()}}),t)})))()},getTaskList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={channel_id:e.form.channel_id,program_id:e.form.program_id,source:e.form.source,doType:e.form.doType,resourcetype:e.form.resourcetype,business:e.form.business},n={page:e.pag.currentPage,limit:e.pag.pageSize,query:Object(S["a"])(a)},e.loading=!0,t.next=5,e.$get("/jobs",n);case 5:if(r=t.sent,s=r.data,o=r.err,!o){t.next=11;break}return e.$message.error(o.msg),t.abrupt("return");case 11:e.pag.total=s.count,e.taskData=s.data,e.loading=!1;case 14:case"end":return t.stop()}}),t)})))()},exportData:function(){var e=this,t={channel_id:this.form.channel_id,program_id:this.form.program_id,source:this.form.source,doType:this.form.doType,resourcetype:this.form.resourcetype,business:this.form.business},a={page:this.pag.currentPage,limit:this.pag.pageSize,export:1,query:Object(S["a"])(t)};Object(j["a"])({method:"get",url:"/jobs",params:a,responseType:"blob"}).then((function(t){if(t.data.type){var a=new Blob([t.data],{type:"application/vnd.ms-excel"}),n=document.createElement("a");n.href=URL.createObjectURL(a),n.setAttribute("download","任务列表.xlsx"),n.click(),n=null,e.$message.success("导出成功")}else e.$message.warning(t.data.msg)})).catch((function(t){console.log(t),e.$message.error(t.msg)}))},handleCurrentChange:function(e){this.pag.currentPage=e,this.getTaskList()},handleSizeChange:function(e){this.pag.pageSize=e,this.getTaskList()},search:function(){this.pag.currentPage=1,this.getTaskList()},clearSearch:function(){for(var e in this.form)this.form[e]=null;this.search()},addTask:function(){this.$router.push({path:"/addTask"})}}},O=z,R=(a("f015"),Object(b["a"])(O,n,r,!1,null,"10255bd4",null));t["default"]=R.exports},fcd9:function(e,t,a){"use strict";var n={statusData:{0:"待绑定","-1":"待解析","-2":"待解析开发","-3":"无法解析",1:"待爬取",2:"爬取中",3:"爬取完成","-4":"取消爬取","-5":"解析故障"},typeData:["整档","单集","短视频"],workData:["KG","Feed","其它"],sourceData:["自动","人工"]};t["a"]=n}}]);