(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e276f2a"],{"3f4e":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-dialog",{attrs:{show:e.show,title:"播放样本",width:"600px","close-on-click-modal":!1},on:{close:e.close}},[a("video-player",{ref:"videoPlayer",attrs:{options:e.playerOptions,playsinline:!0}}),e._t("default")],2)},n=[],s={components:{},props:{show:{type:Boolean,default:function(){return!1}},videoUrl:{type:String,default:function(){return""}}},data:function(){return{playerOptions:{height:"360",autoplay:!0,muted:!1,language:"en",fluid:!0,playbackRates:[.7,1,1.5,2],sources:[{type:"video/mp4",src:""}],poster:"https://surmon-china.github.io/vue-quill-editor/static/images/surmon-1.jpg"}}},computed:{},watch:{},created:function(){this.playerOptions.sources[0].src=this.videoUrl},mounted:function(){},methods:{close:function(){this.$emit("close")}}},i=s,l=a("4ac2"),o=Object(l["a"])(i,r,n,!1,null,"43fb27de",null);t["a"]=o.exports},5926:function(e,t,a){},"7b61":function(e,t,a){},"87c4":function(e,t,a){"use strict";a("5926")},"93d1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sample-bank"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"广告名称"}},[a("el-input",{attrs:{placeholder:"请输入广告名称",clearable:""},model:{value:e.form.ad_title,callback:function(t){e.$set(e.form,"ad_title",t)},expression:"form.ad_title"}})],1),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择频道"},model:{value:e.form.channel_id,callback:function(t){e.$set(e.form,"channel_id",t)},expression:"form.channel_id"}},e._l(e.channelData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{placeholder:"请选择分类",clearable:""},model:{value:e.form.tag,callback:function(t){e.$set(e.form,"tag",t)},expression:"form.tag"}},e._l(e.ad_category,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"样本ID"}},[a("el-input",{attrs:{placeholder:"请输入样本ID",clearable:""},model:{value:e.form.sample_ids,callback:function(t){e.$set(e.form,"sample_ids",t)},expression:"form.sample_ids"}})],1),a("el-form-item",{attrs:{label:"广告ID"}},[a("el-input",{attrs:{placeholder:"请输入广告ID",clearable:""},model:{value:e.form.ad_id,callback:function(t){e.$set(e.form,"ad_id",t)},expression:"form.ad_id"}})],1),a("el-form-item",{attrs:{label:"更新时间"}},[a("el-date-picker",{attrs:{clearable:"",type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.form.update_time,callback:function(t){e.$set(e.form,"update_time",t)},expression:"form.update_time"}})],1),a("div",{staticClass:"btn-wrap"},[a("div",{staticClass:"btn-wrap-left"},[a("base-btn",{on:{click:e.search}},[e._v("查询")]),a("base-btn",{on:{click:e.clear}},[e._v("清除")]),a("base-btn",{on:{click:e.exportData}},[e._v("导出")])],1)])],1),a("SampleTable",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"table-data":e.tableData,pag:e.pag},on:{currentChange:e.handleCurrentChange,sizeChange:e.handleSizeChange,update:function(t){return e.getData()}}})],1)},n=[],s=a("1c03"),i=(a("08ba"),a("fe8a"),a("e18c"),a("96db"),a("af86"),a("f1a9"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sample-table"},[a("p",{staticClass:"table-total"},[e._v("当前条件下共"+e._s(e.pag.total)+"条数据")]),a("el-table",{attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"样本 ID ",width:"80"}}),a("el-table-column",{attrs:{prop:"channel_name",label:"频道",width:"200"}}),a("el-table-column",{attrs:{prop:"ad_id",label:"广告 ID"}}),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"300"}}),a("el-table-column",{attrs:{prop:"tags",label:"分类",width:"180"}}),a("el-table-column",{attrs:{prop:"brand",label:"品牌",width:"200"}}),a("el-table-column",{attrs:{prop:"hash_id",label:"HASH ID",width:"350"}}),a("el-table-column",{attrs:{prop:"updated_at",label:"更新时间",width:"180"}}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("base-btn",{attrs:{type:"text"},on:{click:function(a){return e.playSample(t.row)}}},[e._v("播放")]),e.$store.state.user.userInfo.is_superman||-1!=e.$store.state.user.userInfo.work.indexOf("广告审核管理员")?a("base-btn",{attrs:{type:"text"},on:{click:function(a){return e.updateSample(t.row)}}},[e._v("修改")]):e._e(),e.$store.state.user.userInfo.is_superman||-1!=e.$store.state.user.userInfo.work.indexOf("广告审核管理员")?a("base-btn",{staticClass:"del-btn",attrs:{type:"text"},on:{click:function(a){return e.deleteData(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),a("base-pag",{attrs:{total:e.pag.total,limit:e.pag.limit,page:e.pag.page},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),e.showPlayModel?a("PlaySample",{attrs:{show:e.showPlayModel,"video-url":e.modelData.mp4_url},on:{close:e.closePlayModel}},[a("div",{staticClass:"model-text"},[a("p",[e._v("样本 ID ："+e._s(e.modelData.id))]),a("p",[e._v("标题 ："+e._s(e.modelData.title))]),a("p",[e._v("分类 ："+e._s(e.modelData.tags))]),a("p",[e._v("品牌 ："+e._s(e.modelData.brand))]),a("p",[e._v("样本来源 ："+e._s(e.modelData.channel_name)+" "+e._s(e._f("unixToHms")(e.modelData.start_time))+" - "+e._s(e._f("unixToHms")(e.modelData.end_time)))])])]):e._e(),e.showUpdateModel?a("UpdateSample",{attrs:{show:e.showUpdateModel,"video-url":e.modelData.mp4_url},on:{close:e.closeUpdateModel}},[a("UpdateForm",{attrs:{"model-data":e.modelData},on:{close:e.closeUpdateModel,update:e.updateTable}})],1):e._e()],1)}),l=[],o=a("3f4e"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-dialog",{attrs:{show:e.show,title:"编辑样本",width:"1100px","close-on-click-modal":!1},on:{close:e.close}},[a("div",{staticClass:"updateSampleModel"},[a("div",{staticClass:"sample-video"},[a("video-player",{ref:"videoPlayer",attrs:{options:e.playerOptions,playsinline:!0}})],1),a("div",{staticClass:"sample-form"},[e._t("default")],2)])])},u=[],d=a("99a5"),m=(a("6a61"),a("b794")),p={components:{},props:{show:{type:Boolean,default:function(){return!1}},videoUrl:{type:String,default:function(){return""}}},data:function(){return{playerOptions:{height:"360",autoplay:!0,muted:!1,language:"en",fluid:!0,playbackRates:[.7,1,1.5,2],sources:[{type:"video/mp4",src:""}],poster:"https://surmon-china.github.io/vue-quill-editor/static/images/surmon-1.jpg"}}},computed:{},watch:{},created:function(){this.playerOptions.sources[0].src=this.videoUrl},mounted:function(){var e=this;this.$bus.$on("cutVideoImage",(function(){e.$refs.videoPlayer&&e.getImageSrc(1e3*e.$refs.videoPlayer.player.currentTime())}))},methods:{close:function(){this.$emit("close")},getImageSrc:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["b"])(t.videoUrl,e);case 2:r=a.sent,t.$bus.$emit("setImageData",r);case 4:case"end":return a.stop()}}),a)})))()}}},h=p,f=(a("b5c1"),a("4ac2")),g=Object(f["a"])(h,c,u,!1,null,null,null),b=g.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"ruleForm",attrs:{inline:!0,rules:e.rules,model:e.paramsForm,"label-width":"90px","label-position":"left"}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入标题名称",type:"textarea"},model:{value:e.paramsForm.title,callback:function(t){e.$set(e.paramsForm,"title",t)},expression:"paramsForm.title"}})],1),a("p",{staticClass:"subtitle"},[e._v("基础信息")]),a("el-form-item",{attrs:{label:"商品名称"}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":function(t){return e.filterData(t,0)}},on:{clear:function(t){return e.filterData("",0)}},model:{value:e.paramsForm.product_id,callback:function(t){e.$set(e.paramsForm,"product_id",t)},expression:"paramsForm.product_id"}},e._l(e.productData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"品牌名称"}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":function(t){return e.filterData(t,1)}},on:{clear:function(t){return e.filterData("",1)}},model:{value:e.paramsForm.brand_id,callback:function(t){e.$set(e.paramsForm,"brand_id",t)},expression:"paramsForm.brand_id"}},e._l(e.brandData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"广告主"}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":function(t){return e.filterData(t,2)}},on:{clear:function(t){return e.filterData("",2)}},model:{value:e.paramsForm.ader_id,callback:function(t){e.$set(e.paramsForm,"ader_id",t)},expression:"paramsForm.ader_id"}},e._l(e.aderData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("p",{staticClass:"subtitle"},[e._v("行业分类")]),a("el-form-item",{attrs:{label:"行业大类"}},[a("el-select",{attrs:{filterable:"",clearable:""},on:{change:e.changeIndustryId},model:{value:e.paramsForm.industry_id,callback:function(t){e.$set(e.paramsForm,"industry_id",t)},expression:"paramsForm.industry_id"}},e._l(e.firstIndustry,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"行业中类"}},[a("el-select",{attrs:{filterable:"",clearable:""},on:{change:e.changeSecIndustryId},model:{value:e.paramsForm.sec_industry_id,callback:function(t){e.$set(e.paramsForm,"sec_industry_id",t)},expression:"paramsForm.sec_industry_id"}},e._l(e.secondIndustry,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"行业小类"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.paramsForm.thr_industry_id,callback:function(t){e.$set(e.paramsForm,"thr_industry_id",t)},expression:"paramsForm.thr_industry_id"}},e._l(e.thirdIndustry,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("p",{staticClass:"subtitle"},[e._v("广告分类")]),a("el-form-item",{attrs:{label:"一级分类",prop:"tags_id"}},[a("el-select",{attrs:{filterable:"",clearable:""},on:{change:e.changeTagsId},model:{value:e.paramsForm.tags_id,callback:function(t){e.$set(e.paramsForm,"tags_id",t)},expression:"paramsForm.tags_id"}},e._l(e.firstAd,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"二级分类"}},[a("el-select",{attrs:{filterable:"",clearable:""},on:{change:e.changeSecTagsId},model:{value:e.paramsForm.sec_tags_id,callback:function(t){e.$set(e.paramsForm,"sec_tags_id",t)},expression:"paramsForm.sec_tags_id"}},e._l(e.secondAd,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"三级分类"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.paramsForm.thr_tags_id,callback:function(t){e.$set(e.paramsForm,"thr_tags_id",t)},expression:"paramsForm.thr_tags_id"}},e._l(e.thirdAd,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("div",{staticClass:"key-image-wrap"},[a("p",{staticClass:"subtitle"},[e._v("关键图")]),a("base-btn",{attrs:{disabled:e.cutDisabled},on:{click:e.cutVideoImage}},[e._v("截取")]),a("div",{staticClass:"key-image-content"},e._l(e.keyImageData,(function(t,r){return a("div",{key:r,staticClass:"key-image-item"},[a("base-image",{attrs:{src:t.url}}),a("i",{staticClass:"el-icon-delete-solid",on:{click:function(t){return e.deleteImage(r)}}})],1)})),0)],1),a("el-form-item",{attrs:{label:"广告代言人"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchSpokesman,placeholder:"请输入广告代言人",maxlength:50,type:"textarea"},model:{value:e.paramsForm.spokesman,callback:function(t){e.$set(e.paramsForm,"spokesman",t)},expression:"paramsForm.spokesman"}})],1),a("el-form-item",{attrs:{label:"广告语"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchSlogan,placeholder:"请输入广告语",maxlength:50,type:"textarea"},model:{value:e.paramsForm.slogan,callback:function(t){e.$set(e.paramsForm,"slogan",t)},expression:"paramsForm.slogan"}})],1),a("el-form-item",{attrs:{label:"主题分类"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchSubject,placeholder:"请输入主题分类",maxlength:50,type:"textarea"},model:{value:e.paramsForm.subject,callback:function(t){e.$set(e.paramsForm,"subject",t)},expression:"paramsForm.subject"}})],1),a("el-form-item",{attrs:{label:"广告系列"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchSeries,placeholder:"请输入广告系列",maxlength:50,type:"textarea"},model:{value:e.paramsForm.series,callback:function(t){e.$set(e.paramsForm,"series",t)},expression:"paramsForm.series"}})],1),a("el-form-item",{attrs:{label:"制作机构"}},[a("el-autocomplete",{attrs:{"fetch-suggestions":e.querySearchOrganization,placeholder:"请输入制作机构",maxlength:50,type:"textarea"},model:{value:e.paramsForm.organization,callback:function(t){e.$set(e.paramsForm,"organization",t)},expression:"paramsForm.organization"}})],1),a("el-form-item",{attrs:{label:"语言"}},[a("el-select",{model:{value:e.paramsForm.language,callback:function(t){e.$set(e.paramsForm,"language",t)},expression:"paramsForm.language"}},[a("el-option",{attrs:{label:"中文",value:"中文"}}),a("el-option",{attrs:{label:"英文",value:"英文"}}),a("el-option",{attrs:{label:"韩语",value:"韩语"}}),a("el-option",{attrs:{label:"日语",value:"日语"}})],1)],1)],1),a("div",{staticClass:"btn-wrap"},[a("base-btn",{attrs:{disabled:e.disabled},on:{click:function(t){return e.confirm("ruleForm")}}},[e._v("确定")]),a("base-btn",{attrs:{type:"info"},on:{click:e.close}},[e._v("取消")])],1)],1)},y=[],v=(a("ea69"),a("4194"),a("053b"),a("513c"),{components:{},props:{modelData:{type:Object,default:function(){return{}}}},data:function(){return{categories:["公益广告","商业广告","购物广告","植入广告","赞助广告"],paramsForm:{tags:"",title:"",brand_id:null,product_id:null,tags_id:null,sec_tags_id:null,thr_tags_id:null,industry_id:null,sec_industry_id:null,thr_industry_id:null,ader_id:null,spokesman:"",subject:"",slogan:"",series:"",organization:"",language:"中文"},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],tags_id:[{required:!0,message:"请选择一级广告分类",trigger:"change"}]},baseMessage:[{key:"productData",label:"商品"},{key:"brandData",label:"品牌"},{key:"aderData",label:"广告主"}],cateGoryData:[{key:"firstIndustry",label:"行业",level:"一级"},{key:"firstAd",label:"广告",level:"一级"}],productData:[],brandData:[],aderData:[],firstIndustry:[],secondIndustry:[],thirdIndustry:[],firstAd:[],secondAd:[],thirdAd:[],keyImageData:[],disabled:!1,cutDisabled:!1}},computed:{},watch:{},created:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.cateGoryData.forEach((function(t){e.getCategoryData(t)})),Object.keys(e.paramsForm).forEach((function(t){e.paramsForm[t]=e.modelData[t]})),e.baseMessage.forEach((function(t,a){var r=JSON.parse(JSON.stringify(t));switch(a){case 0:r.id=e.paramsForm.product_id;break;case 1:r.id=e.paramsForm.brand_id;break;case 2:r.id=e.paramsForm.ader_id;break}e.getBaseMessageData(r)})),e.keyImageData=e.modelData.img_list||[],t.next=6,e.getIndustryData();case 6:return t.next=8,e.getSecIndustryData();case 8:return t.next=10,e.getTagsData();case 10:return t.next=12,e.getSecTagsData();case 12:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;this.$bus.$on("setImageData",(function(t){e.keyImageData.push({url:t,path:""}),e.cutDisabled=!1}))},methods:{querySearchAsync:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,a.getTitleList(e);case 2:n=r.sent,s=[],n.forEach((function(e){s.push({id:e.id,value:e.title})})),t(s);case 6:case"end":return r.stop()}}),r)})))()},getTitleList:function(e){var t=this,a={channel_id:this.modelData.channel_id,keyword:e};return new Promise((function(e,r){t.$get("/epg-ad/epg-ad-search",a).then((function(t){e(t.data.list)})).catch((function(e){t.$message(e.msg)}))}))},confirm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e||t.checkImg())return console.log("error submit!!"),!1;t.disabled=!0,t.changeImg()}))},checkImg:function(){var e="";return this.keyImageData.length||(e="请截取关键图"),e&&this.$message.error(e),e},deleteImage:function(e){this.keyImageData.splice(e,1)},changeImg:function(){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,a=0;case 2:if(!(a<e.keyImageData.length)){t.next=15;break}if(e.keyImageData[a].path){t.next=12;break}return r=(new Date).getTime()+".jpg",t.next=7,Object(m["a"])(e.keyImageData[a].url,r);case 7:return n=t.sent,s=new FormData,s.append("photo",n),t.next=12,e.uploadImg(s,a);case 12:a++,t.next=2;break;case 15:e.submit(),t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](0),e.disabled=!1,alert(t.t0);case 22:case"end":return t.stop()}}),t,null,[[0,18]])})))()},uploadImg:function(e,t){var a=this;return new Promise((function(r,n){a.$post("/ad-sample/upload-img",e).then((function(e){a.keyImageData[t].path=e.data.file_path,r()})).catch((function(e){n(e)}))}))},getImgList:function(){var e=[];return this.keyImageData.forEach((function(t){e.push(t.path)})),e},submit:function(){var e=this,t={data_id:this.modelData.id,action:"update",seq:Object(s["a"])({brand:this.getBrandName(),img_list:this.getImgList()},this.paramsForm)};this.$post("/ad-sample/modify",t).then((function(t){e.$message({type:"success",message:"更新成功"}),e.$emit("update"),e.close()})).catch((function(t){e.$message({type:"warning",message:t.msg})}))},getBrandName:function(){var e=this,t=this.brandData.find((function(t){return t.id===e.paramsForm.brand_id}));return t?t.name:""},close:function(){this.$emit("close")},cutVideoImage:function(){if(this.cutDisabled=!0,this.keyImageData.length>=10)return this.cutDisabled=!1,void this.$message({type:"warning",message:"截取关键图不能超过10个"});this.$bus.$emit("cutVideoImage")},filterData:function(e,t){var a=this.baseMessage[t];a.name=e,this.getBaseMessageData(a)},getBaseMessageData:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r={type:e.label,page:1,limit:20,ids:e.id||null,name:e.name||""},t.$get("/ad-sample/ad-additional/list",r).then((function(a){t.$data[e.key]=a.data.list})).catch((function(e){t.$message.error(e.msg)}));case 2:case"end":return a.stop()}}),a)})))()},getCategoryData:function(e){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r={type:e.label,level:e.level,pid:e.pid||null,page:1,limit:5e3},t.$get("/ad-sample/ad-type/list",r).then((function(a){t.$data[e.key]=a.data.list})).catch((function(e){t.$message.error(e.msg)}));case 2:case"end":return a.stop()}}),a)})))()},changeIndustryId:function(e){this.paramsForm.sec_industry_id=null,this.paramsForm.thr_industry_id=null,this.getIndustryData()},getIndustryData:function(){if(!this.paramsForm.industry_id)return this.secondIndustry=[],void(this.thirdIndustry=[]);var e={level:"二级",type:"行业",key:"secondIndustry",pid:this.paramsForm.industry_id};this.getCategoryData(e)},changeSecIndustryId:function(){this.paramsForm.thr_industry_id=null,this.getSecIndustryData()},getSecIndustryData:function(){if(this.paramsForm.sec_industry_id){var e={level:"三级",type:"行业",key:"thirdIndustry",pid:this.paramsForm.sec_industry_id};this.getCategoryData(e)}else this.thirdIndustry=[]},changeTagsId:function(e){var t=this.firstAd.find((function(t){return t.id===Number(e)}));this.paramsForm.tags=t?t.name:"",this.paramsForm.sec_tags_id=null,this.paramsForm.thr_tags_id=null,this.getTagsData()},getTagsData:function(){if(!this.paramsForm.tags_id)return this.secondAd=[],void(this.thirdAd=[]);var e={level:"二级",type:"广告",key:"secondAd",pid:this.paramsForm.tags_id};this.getCategoryData(e)},changeSecTagsId:function(){this.paramsForm.thr_tags_id=null,this.getSecTagsData()},getSecTagsData:function(){if(this.paramsForm.sec_tags_id){var e={level:"三级",type:"广告",key:"thirdAd",pid:this.paramsForm.sec_tags_id};this.getCategoryData(e)}else this.thirdAd=[]},getSampleData:function(e){var t=this;return e.page=1,e.limit=5e3,new Promise((function(a,r){t.$get("/ad-sample/search",e).then((function(e){a(e.data.list)})).catch((function(e){t.$message(e.msg)}))}))},getSampleShowArr:function(e,t){var a=[];return e.forEach((function(e){e[t]&&a.push({id:e.id,value:e[t]})})),a},querySearchSpokesman:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={spokesman:e},r.next=3,a.getSampleData(n);case 3:s=r.sent,t(a.getSampleShowArr(s,"spokesman"));case 5:case"end":return r.stop()}}),r)})))()},querySearchSlogan:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={slogan:e},r.next=3,a.getSampleData(n);case 3:s=r.sent,t(a.getSampleShowArr(s,"slogan"));case 5:case"end":return r.stop()}}),r)})))()},querySearchSubject:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={subject:e},r.next=3,a.getSampleData(n);case 3:s=r.sent,t(a.getSampleShowArr(s,"subject"));case 5:case"end":return r.stop()}}),r)})))()},querySearchSeries:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={series:e},r.next=3,a.getSampleData(n);case 3:s=r.sent,t(a.getSampleShowArr(s,"series"));case 5:case"end":return r.stop()}}),r)})))()},querySearchOrganization:function(e,t){var a=this;return Object(d["a"])(regeneratorRuntime.mark((function r(){var n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n={organization:e},r.next=3,a.getSampleData(n);case 3:s=r.sent,t(a.getSampleShowArr(s,"organization"));case 5:case"end":return r.stop()}}),r)})))()}}}),D=v,k=(a("ef9e"),Object(f["a"])(D,_,y,!1,null,"49aa5000",null)),w=k.exports,x={components:{PlaySample:o["a"],UpdateSample:b,UpdateForm:w},props:{tableData:{type:Array,default:function(){return[]}},pag:{type:Object,default:function(){return{}}}},data:function(){return{showPlayModel:!1,showUpdateModel:!1,modelData:{}}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{handleCurrentChange:function(e){this.$emit("currentChange",e)},handleSizeChange:function(e){this.$emit("sizeChange",e)},deleteData:function(e){var t=this;this.$confirm("删除不可逆，请确定！","提示",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then((function(){t.modelData=e,t.deleteSample()})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},deleteSample:function(){var e=this,t={data_id:this.modelData.id,action:"delete",seq:{title:this.modelData.title,tags:this.modelData.tags}};this.$post("/ad-sample/modify",t).then((function(t){e.$message({type:"success",message:"删除成功"}),e.$emit("update")})).catch((function(t){e.$message({type:"warning",message:t.msg})}))},playSample:function(e){this.modelData=e,this.showPlayModel=!0},updateSample:function(e){this.showUpdateModel=!0,this.modelData=e},updateTable:function(){this.$emit("update")},closePlayModel:function(){this.showPlayModel=!1},closeUpdateModel:function(){this.showUpdateModel=!1}}},F=x,$=(a("c5cd"),Object(f["a"])(F,i,l,!1,null,"dd76bab8",null)),S=$.exports,I=a("52c1"),C=a("28de"),O={components:{SampleTable:S},props:{},data:function(){return{form:{ad_title:"",tag:"",ad_id:"",category:"",sample_ids:"",update_time:[],channel_id:null},pag:{page:1,limit:10,total:0},tableData:[],loading:!0,ad_category:["公益广告","商业广告","购物广告","植入广告","赞助广告"]}},computed:Object(s["a"])({},Object(I["b"])(["channelData","token"])),watch:{},created:function(){this.getData(),this.channelData.length||this.$store.dispatch("channel/getChannelData")},mounted:function(){},methods:{handleCurrentChange:function(e){this.pag.page=e,this.getData()},handleSizeChange:function(e){this.pag.limit=e,this.getData()},search:function(){this.pag.page=1,this.getData()},clear:function(){var e=this;Object.keys(this.form).forEach((function(t){e.form[t]=""})),this.form.update_time=[],this.getData()},exportData:function(){var e=this;Object(C["a"])({method:"get",url:"/ad-sample/export",headers:{token:this.token},params:{sample_ids:this.form.sample_ids,tag:this.form.tag,channel_id:this.form.channel_id,ad_id:this.form.ad_id,ad_title:this.form.ad_title,updated_at_start:this.form.update_time?this.form.update_time[0]:null,updated_at_end:this.form.update_time?this.form.update_time[1]:null},responseType:"blob"}).then((function(t){if(t.data.type){var a=new Blob([t.data],{type:"application/vnd.ms-excel"}),r=document.createElement("a");r.href=URL.createObjectURL(a),r.setAttribute("download","样本库.xlsx"),r.click(),r=null,e.$message.success("导出成功")}else e.$message.warning(t.data.msg)})).catch((function(e){console.log(e)}))},getData:function(){var e=this;this.loading=!0;var t={ad_title:this.form.ad_title,ad_id:this.form.ad_id,sample_ids:this.form.sample_ids,updated_at_start:this.form.update_time?this.form.update_time[0]:null,updated_at_end:this.form.update_time?this.form.update_time[1]:null,page:this.pag.page,limit:this.pag.limit,show_delete:0,tag:this.form.tag,channel_id:this.form.channel_id};this.$get("/ad-sample/search",t).then((function(t){e.tableData=t.data.list,e.pag.total=t.data.total})).catch((function(e){console.log(e.msg)})).finally((function(){e.loading=!1}))}}},j=O,A=(a("87c4"),Object(f["a"])(j,r,n,!1,null,"790f28c9",null));t["default"]=A.exports},b2da:function(e,t,a){},b5c1:function(e,t,a){"use strict";a("b2da")},b794:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return s}));a("e35a"),a("0d7a"),a("3e54"),a("e18c"),a("8256"),a("ab6e"),a("927c"),a("3c51"),a("db0a"),a("1cc1"),a("ab0f"),a("fc6e"),a("f30b"),a("cfd1"),a("d104"),a("f74a"),a("3598"),a("b497"),a("2909"),a("a7ef"),a("b523"),a("e671"),a("4140"),a("83db"),a("829d"),a("939f"),a("1bb1"),a("c3ba"),a("f4e3"),a("b4fb");var r=a("79dd");function n(e,t){return new r["Promise"]((function(a,r){var n=document.createElement("canvas"),s=document.createElement("video");s.src=e,s.currentTime=t/1e3,s.crossOrigin="Anonymous",s.addEventListener("loadeddata",(function(){n.width=1*s.videoWidth,n.height=1*s.videoHeight,n.getContext("2d").drawImage(s,0,0,n.width,n.height);var e="";try{e=n.toDataURL("image/png"),a(e)}catch(t){r(t)}}))}))}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",a=e.split(","),r=a[0].match(/:(.*?);/)[1],n=r.split("/")[1],s=atob(a[1]),i=s.length,l=new Uint8Array(i);while(i--)l[i]=s.charCodeAt(i);return new File([l],"".concat(t,".").concat(n),{type:r})}},c5cd:function(e,t,a){"use strict";a("e00c")},e00c:function(e,t,a){},ef9e:function(e,t,a){"use strict";a("7b61")}}]);