(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f618f7c"],{"1b8a":function(t,e,i){"use strict";i("1e71")},"1e71":function(t,e,i){},3703:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"trackHeader"},[i("ul",{staticClass:"btn-list"},[i("li",[i("a",{on:{click:function(e){return t.addCutTrakOfMobile()}}},[i("i",{staticClass:"iconfont icon-ziyuan"})])]),i("li",[i("a",{on:{click:function(e){return t.deleteDecorate()}}},[i("i",{staticClass:"iconfont icon-shanchu"})])]),i("li",{staticClass:"export-btn"},[i("div",{on:{click:function(e){return t.exportVideo()}}},[t._v("导出视频")])])])])},s=[],r=(i("4194"),i("fe59"),i("d497"),i("08ba"),i("0ce9")),c=i("3532"),n={props:{},data:function(){return{track_s:0}},mixins:[r["a"]],computed:{PER_PX_MS:function(){return this.$store.state.PER_PX_MS},duration:function(){return this.$store.state.videoPlay.duration},decorate_active_id:function(){return this.$store.state.decorate_active_id},active_track:function(){var t=this,e=this.$store.state.decorate_list;return e.find((function(e){return e.id==t.decorate_active_id}))},cutDetails:function(){return this.$store.state.cut_details}},watch:{},methods:{addCutTrakOfMobile:function(){parseInt(this.$store.state.videoPlay.current_time_ms),parseInt(this.$store.state.PER_PX_MS);var t=document.getElementById("videoCanvas"),e=this.$store.state.decorate_list,i=this.duration/this.PER_PX_MS;if(!e.some((function(t){return"裁剪"==t.type}))){var a=t.height,s=a*(9/16),r=t.width/2-s/2,n={x:r,y:0,w:s,h:a,id:"decorate_"+Object(c["a"])(),active:!0,type:"裁剪",trackLeft:0,resizable:!1,trackWidth:i};this.addTrackData(n)}},activeBtnList:function(t){var e=this;if("setMosaicList"==t.data.cmd){var i=t.data.data,a=document.getElementById("videoCanvas"),s=a.width,r=a.height,n=document.getElementById("myVideo"),o=n.videoWidth,d=n.videoHeight;i.forEach((function(t){var i=t.y/d*r,a=t.x/o*s,n=t.width/o*s,h=t.height/d*r,u={active:!1,w:n,x:a,y:i,h:h,id:"decorate_"+Object(c["a"])(),trackLeft:t.start_ms/e.PER_PX_MS,trackWidth:(t.end_ms-t.start_ms)/e.PER_PX_MS,type:t.type||"马赛克"};e.addTrackData(u)}))}},setMs:function(){if(this.active_track){var t=this.duration/this.PER_PX_MS,e=1e3*this.track_s/this.PER_PX_MS,i=Math.min(t,e);this.setTrackData({trackWidth:i},this.decorate_active_id)}},setMaxMs:function(){if(this.active_track){var t=this.duration/this.PER_PX_MS,e=t-this.active_track.trackLeft;this.setTrackData({trackWidth:e},this.decorate_active_id)}},addDecorate:function(){var t=parseInt(this.$store.state.videoPlay.current_time_ms),e=parseInt(this.$store.state.PER_PX_MS),i={x:10,y:10,w:100,h:50,id:"decorate_"+Object(c["a"])(),active:!1,type:"马赛克",trackLeft:(t-e)/e,trackWidth:100};this.addTrackData(i)},addCutTrak:function(){var t=this.$store.state.decorate_list,e=this.duration/this.PER_PX_MS;if(!t.some((function(t){return"裁剪"==t.type}))){var i={x:10,y:10,w:400,h:300,id:"decorate_"+Object(c["a"])(),active:!0,type:"裁剪",trackLeft:0,trackWidth:e};this.addTrackData(i)}},exportVideo:function(){var t=this.$store.state.decorate_list,e=[],i=this.$store.state.PER_PX_MS,a=document.getElementById("myVideo"),s=a.videoWidth,r=a.videoHeight,c=document.getElementById("videoCanvas"),n=c.width,o=c.height;t.forEach((function(t){var a=t.y/o*r,c=t.x/n*s,d=t.w/n*s,h=t.h/o*r,u=t.trackLeft*i,_={start_ms:u<500?0:u,end_ms:(t.trackLeft+t.trackWidth)*i,y:a,x:c,width:d,height:h,type:t.type};e.push(_)})),window.parent.postMessage({cmd:"exportArr",data:e},"*");var d=this.exportcutDetails(),h={width:s,height:r};window.parent.postMessage({cmd:"exportAllData",data:{cutDetails:d,decorateList:e,videoSize:h}},"*")},exportcutDetails:function(){var t=this.cutDetails.trackLeft*this.PER_PX_MS,e=(this.cutDetails.trackLeft+this.cutDetails.trackWidth)*this.PER_PX_MS,i={start_ms:t<500?0:t,end_ms:this.duration-e<500?this.duration:e};return i},deleteDecorate:function(){this.deleteTrackData(this.$store.state.decorate_active_id)}},components:{},created:function(){},mounted:function(){window.addEventListener("message",this.activeBtnList,!1)}},o=n,d=(i("1b8a"),i("2c07")),h=Object(d["a"])(o,a,s,!1,null,"1fce1f4f",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-6f618f7c.a6bb4ff7.js.map