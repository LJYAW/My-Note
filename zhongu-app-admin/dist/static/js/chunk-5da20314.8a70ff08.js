(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5da20314"],{2335:function(e,t,r){},"27fc":function(e,t,r){"use strict";r("91b9")},3011:function(e,t,r){},"50ed":function(e,t,r){},5290:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-manage"},[r("base-tab",{attrs:{"tab-arr":e.tabArr}}),r("Search",{on:{search:e.search}}),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e.orderData.length?r("InfoWrap",{attrs:{"order-data":e.orderData,pag:e.pag},on:{sizeChange:e.sizeChange,currentChange:e.currentChange,update:e.getOrderData}}):r("svg-icon",{staticClass:"empty-img",attrs:{"icon-class":"empty-img"}})],1)],1)},n=[],s=r("e9ff"),i=(r("e186"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"search-wrap"},[r("base-form-presend",{attrs:{label:"用户账号"}},[r("el-input",{attrs:{placeholder:"请输入用户账号",size:"mini",clearable:"",maxlength:30},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),r("base-form-presend",{attrs:{label:"用户昵称"}},[r("el-input",{attrs:{placeholder:"请输入用户昵称",size:"mini",clearable:"",maxlength:30},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),r("br"),r("base-form-presend",{attrs:{label:"订单编号"}},[r("el-input",{attrs:{placeholder:"请输入订单编号",size:"mini",clearable:"",maxlength:30},model:{value:e.form.order_no,callback:function(t){e.$set(e.form,"order_no",t)},expression:"form.order_no"}})],1),r("base-form-presend",{attrs:{label:"订单日期"}},[r("el-date-picker",{attrs:{format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"mini",clearable:""},model:{value:e.form.pay_at,callback:function(t){e.$set(e.form,"pay_at",t)},expression:"form.pay_at"}})],1),r("base-form-presend",{attrs:{label:"订单金额"}},[r("el-input-number",{attrs:{controls:!1,size:"mini",max:999999},model:{value:e.form.minPrice,callback:function(t){e.$set(e.form,"minPrice",t)},expression:"form.minPrice"}}),e._v(" 至 "),r("el-input-number",{attrs:{controls:!1,size:"mini",max:999999},model:{value:e.form.maxPrice,callback:function(t){e.$set(e.form,"maxPrice",t)},expression:"form.maxPrice"}})],1),r("base-form-presend",{attrs:{label:"订单状态"}},[r("el-select",{attrs:{size:"mini",clearable:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.status,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("div",{staticClass:"btn-wrap"},[r("base-btn",{on:{click:e.search}},[e._v("查询订单")]),r("base-btn",{attrs:{type:"info"},on:{click:e.clearData}},[e._v("清空信息")]),r("base-btn",{on:{click:e.exportExt}},[e._v("导出待发货订单")])],1)],1)}),o=[],c=(r("e35a"),r("9cf3"),r("e18c"),r("96db"),r("af86"),r("f1a9"),r("c370"),{components:{},props:{},data:function(){return{form:{phone:null,nickname:null,order_no:null,pay_at:"",minPrice:void 0,maxPrice:void 0,status:null},status:["待付款","待发货","运输中","已完成","已取消","已退款"]}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{search:function(){this.$emit("search",this.form)},clearData:function(){for(var e in this.form)this.form[e]=null,this.form.minPrice=void 0,this.form.maxPrice=void 0;this.search()},exportExt:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$axios({url:"/admin/goods-order/export",method:"GET",responseType:"blob"}).then((function(e){var t=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t,r.setAttribute("download","file.xlsx"),document.body.appendChild(r),r.click()}));case 1:case"end":return t.stop()}}),t)})))()}}}),u=c,l=(r("b7c2"),r("cba8")),m=Object(l["a"])(u,i,o,!1,null,"31331754",null),d=m.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-info-wrap"},[r("div",{staticClass:"order-info-content"},e._l(e.orderData,(function(t){return r("div",{key:t.id,staticClass:"order-item"},[r("div",{staticClass:"order-base-wrap"},[r("p",[e._v("订单编号："+e._s(t.order_no))]),r("p",[e._v("订单日期："+e._s(t.created_at))]),r("p",[e._v("用户账号："+e._s(t.info_snapshot.user.phone))]),r("p",{staticClass:"order-status"},[e._v("订单状态："+e._s(t.status))])]),r("div",{staticClass:"order-product-wrap"},[r("div",{staticClass:"product-wrap"},e._l(t.info_snapshot.goods_list,(function(t){return r("div",{key:t.id,staticClass:"product-item"},[r("base-image",{attrs:{src:t.main_img}}),r("div",{staticClass:"product-message"},[r("div",[r("p",{staticClass:"message name"},[e._v(e._s(t.name))]),r("p",{staticClass:"message"},[e._v("数量："+e._s(t.goods_num))]),r("p",{staticClass:"message"},[e._v("价格：￥"+e._s(t.price))])]),r("p",{staticClass:"number"},[e._v(e._s(t.number))])])],1)})),0),r("div",{staticClass:"btn-wrap"},[r("p",[e._v("总计金额："+e._s((t.total_amount_fen/100).toFixed(0)))])]),r("div",{staticClass:"btn-wrap"},[r("base-btn",{attrs:{type:"text"},on:{click:function(r){return e.routerGo("/order-detail",t.id)}}},[e._v("订单详情")])],1),r("div",{staticClass:"btn-wrap close-wrap"},["待发货"==t.status?r("base-btn",{attrs:{type:"text"},on:{click:function(r){return e.deliver(t.id)}}},[e._v("立即发货")]):e._e(),"运输中"==t.status||"已完成"==t.status?r("base-btn",{attrs:{type:"text"},on:{click:function(r){return e.routerGo("/logistics-message",t.id)}}},[e._v("查看物流")]):e._e(),"待付款"==t.status?r("base-btn",{staticClass:"close-btn",attrs:{type:"text"},on:{click:function(r){return e.closeOrder(t)}}},[e._v("关闭订单")]):e._e()],1)])])})),0),r("base-pag",{attrs:{page:e.pag.page,limit:e.pag.limit,total:e.pag.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),r("base-dialog",{attrs:{show:e.dialogVisible,width:"500px",title:"立即发货"},on:{"update:show":function(t){e.dialogVisible=t}}},[r("Deliver",{attrs:{"product-id":e.productId},on:{close:e.close}})],1)],1)},p=[],g=r("968f"),h={components:{Deliver:g["a"]},props:{orderData:{type:Array,default:function(){return[]}},pag:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:!1,productId:null}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{deliver:function(e){this.dialogVisible=!0,this.productId=e},close:function(){this.dialogVisible=!1,this.$emit("update")},routerGo:function(e,t){this.$router.push({path:e,query:{id:t}})},handleSizeChange:function(e){this.$emit("sizeChange",e)},handleCurrentChange:function(e){this.$emit("currentChange",e)},closeOrder:function(e){var t=this;this.$confirm("确认要关闭此订单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.confirmClose(e)})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},confirmClose:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={status:"已取消",tracking:{tracking_company:e.tracking_company,tracking_code:e.tracking_code,tracking_number:e.tracking_number}},r.next=3,t.$put("/admin/goods-order/".concat(e.id,"/status"),a);case 3:if(n=r.sent,s=n.err,n.res,!s){r.next=9;break}return t.$message.error(s.msg),r.abrupt("return");case 9:t.$emit("update");case 10:case"end":return r.stop()}}),r)})))()}}},b=h,v=(r("27fc"),Object(l["a"])(b,f,p,!1,null,"53edddc3",null)),_=v.exports,k={components:{Search:d,InfoWrap:_},props:{},data:function(){return{tabArr:["订单搜索"],orderData:[],form:{},pag:{page:1,limit:20,total:0},loading:!1}},computed:{},watch:{},created:function(){this.getOrderData()},mounted:function(){},methods:{search:function(e){this.pag.page=1,this.form=e,this.getOrderData()},sizeChange:function(e){this.pag.limit=e,this.getOrderData()},currentChange:function(e){this.pag.page=e,this.getOrderData()},getOrderData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,r=e.setParams(),t.next=4,e.$get("/admin/goods-order",r);case 4:if(a=t.sent,n=a.err,s=a.res,!n){t.next=10;break}return e.$message.error(n.msg),t.abrupt("return");case 10:e.loading=!1,e.orderData=s.data.list,e.pag.total=s.data.total;case 13:case"end":return t.stop()}}),t)})))()},setParams:function(){return{phone:this.form.phone,nickname:this.form.nickname,status:this.form.status,created_at:this.form.pay_at?this.form.pay_at[0]+"|"+this.form.pay_at[1]:"",total_amount_fen:this.getPriceParams(),order_no:this.form.order_no,page:this.pag.page,limit:this.pag.limit}},getPriceParams:function(){return this.form.minPrice||this.form.maxPrice?(this.form.minPrice||"")+"|"+(this.form.maxPrice||""):""}}},x=k,y=(r("ddc2"),Object(l["a"])(x,a,n,!1,null,"2c6da19b",null));t["default"]=y.exports},"91b9":function(e,t,r){},"968f":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-deliver"},[r("el-form",{ref:"ruleForm",attrs:{model:e.form,inline:!0,rules:e.rules}},[r("el-form-item",{attrs:{label:"快递公司",prop:"tracking_code"}},[r("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.form.tracking_code,callback:function(t){e.$set(e.form,"tracking_code",t)},expression:"form.tracking_code"}},e._l(e.companyData,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1),r("el-form-item",{attrs:{label:"快递单号",prop:"tracking_number"}},[r("el-input",{model:{value:e.form.tracking_number,callback:function(t){e.$set(e.form,"tracking_number",t)},expression:"form.tracking_number"}})],1)],1),r("base-btn",{staticClass:"deliver-btn",on:{click:e.commit}},[e._v("立即发货")])],1)},n=[],s=r("06c4"),i=r("e9ff"),o=(r("e186"),r("513c"),r("4194"),r("053b"),{components:{},props:{productId:{type:Number,default:function(){return null}}},data:function(){return{form:{tracking_number:null,tracking_code:null},rules:{tracking_code:[{required:!0,message:"请选择快递公司",trigger:"change"}],tracking_number:[{required:!0,message:"请输入快递单号",trigger:"blur"}]},companyData:[]}},computed:{tracking_company:function(){var e=this,t=this.companyData.find((function(t){return t.code===e.form.tracking_code}));return t.name||""}},watch:{},created:function(){this.getCompanyData()},mounted:function(){},methods:{getCompanyData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$get("/configs/kuaidi");case 2:if(r=t.sent,a=r.err,n=r.res,!a){t.next=8;break}return e.$message.error(a.msg),t.abrupt("return");case 8:e.companyData=n.data.list;case 9:case"end":return t.stop()}}),t)})))()},commit:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.submit()}))},submit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={status:"运输中",tracking:Object(s["a"])({tracking_company:e.tracking_company},e.form)},t.next=3,e.$put("/admin/goods-order/".concat(e.productId,"/status"),r);case 3:if(a=t.sent,n=a.err,a.res,!n){t.next=9;break}return e.$message.error(n.msg),t.abrupt("return");case 9:e.$emit("close");case 10:case"end":return t.stop()}}),t)})))()}}}),c=o,u=(r("ec8f"),r("cba8")),l=Object(u["a"])(c,a,n,!1,null,"7d988098",null);t["a"]=l.exports},"9cf3":function(e,t,r){"use strict";var a=r("b2a2"),n=r("857c"),s=r("2732"),i=r("9d5c"),o=r("59da");a("search",1,(function(e,t,r){return[function(t){var r=s(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,r):new RegExp(t)[e](String(r))},function(e){var a=r(t,e,this);if(a.done)return a.value;var s=n(e),c=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var l=o(s,c);return i(s.lastIndex,u)||(s.lastIndex=u),null===l?-1:l.index}]}))},"9d5c":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},b7c2:function(e,t,r){"use strict";r("3011")},ddc2:function(e,t,r){"use strict";r("2335")},ec8f:function(e,t,r){"use strict";r("50ed")}}]);