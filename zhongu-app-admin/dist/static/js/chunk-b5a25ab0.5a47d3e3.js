(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b5a25ab0"],{"0e5c":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("e18c");var a=r("eca5"),n=function(e){var t=new FormData;return t.append("photo",e),new Promise((function(e,r){Object(a["c"])("/admin/util/upload-img",t).then((function(t){e(t)})).catch((function(e){return r(e)}))}))}},11768:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ClassForm")},n=[],s=r("da71"),i={components:{ClassForm:s["a"]},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},o=i,c=r("cba8"),l=Object(c["a"])(o,a,n,!1,null,"4e293aba",null);t["default"]=l.exports},"98cd":function(e,t,r){},da71:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"new-class"},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"new-class-form"},[r("el-form",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,inline:!0}},[r("el-form-item",{attrs:{prop:"name",label:"分类名称"}},[r("el-input",{attrs:{maxlength:10,placeholder:"分类名称最多十个字",clearable:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{prop:"intro",label:"分类简介"}},[r("el-input",{attrs:{maxlength:12,placeholder:"分类简介最多12个字符",clearable:""},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro","string"===typeof t?t.trim():t)},expression:"form.intro"}})],1),e._l(e.imgData,(function(t,a){return r("el-form-item",{key:t.prop,attrs:{prop:t.prop,label:t.label}},[r("div",{staticClass:"image-wrap"},[e.form[t.prop]?r("div",[r("base-upload",{attrs:{"button-name":""},on:{getFileUrl:function(t){return e.getFileData(arguments,a)}}},[r("base-image",{attrs:{src:e.form[t.prop],fit:"contain"}}),r("p",{staticClass:"btn"},[e._v("点击更换图片")])],1)],1):r("div",[r("base-upload",{staticClass:"uplaod-btn",attrs:{"button-name":""},on:{getFileUrl:function(t){return e.getFileData(arguments,a)}}},[r("svg-icon",{staticClass:"upload-icon",attrs:{"icon-class":"file"}}),r("p",{staticClass:"btn"},[e._v("点击上传图片")])],1)],1),r("p",{staticClass:"image-size"},[e._v("固定尺寸 "+e._s(t.size)+"px png格式")])])])})),r("el-form-item",{attrs:{label:"分类描述",prop:"des"}},[r("div",{staticClass:"image-wrap textarea-wrap"},[r("el-input",{attrs:{type:"textarea",maxlength:30,placeholder:"分类描述最多30个字符"},model:{value:e.form.des,callback:function(t){e.$set(e.form,"des","string"===typeof t?t.trim():t)},expression:"form.des"}})],1)])],2)],1),r("div",{staticClass:"btn-wrap"},[r("base-btn",{staticClass:"clear-btn",attrs:{type:"info"},on:{click:e.clear}},[e._v("清空数据")]),r("base-btn",{attrs:{disabled:e.disabled},on:{click:e.confirm}},[e._v("确认保存")]),r("base-btn",{on:{click:e.routeTo}},[e._v("返回")])],1)])},n=[],s=r("e9ff"),i=(r("e35a"),r("0d7a"),r("513c"),r("e186"),{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],intro:[{required:!0,message:"请输入分类简介",trigger:"change"}],small_img:[{required:!0,message:"请上传分类主形象图",trigger:"blur"}],main_img:[{required:!0,message:"请上传分类主图",trigger:"blur"}],banner_img:[{required:!0,message:"请上传分类banner图",trigger:"blur"}],des:[{required:!0,message:"请输入分类描述",trigger:"blur"}]}),o=i,c=r("0e5c"),l=r("d340"),u={components:{},props:{},data:function(){return{form:{name:"",intro:"",small_img:"",main_img:"",banner_img:"",des:""},rules:o,imgData:[{prop:"small_img",label:"分类主形象",size:"110X130"},{prop:"main_img",label:"分类主图",size:"330X330"},{prop:"banner_img",label:"分类banner",size:"678X300"}],loading:!1,disabled:!1}},computed:{},watch:{},created:function(){this.$route.query.id&&this.getClassData()},mounted:function(){},methods:{getClassData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,r={ids:e.$route.query.id},t.next=4,e.$get("/admin/categories",r);case 4:if(a=t.sent,n=a.err,s=a.res,e.loading=!1,!n){t.next=11;break}return e.$message.error(n.msg),t.abrupt("return");case 11:e.form=JSON.parse(JSON.stringify(s.data.list[0]));case 12:case"end":return t.stop()}}),t)})))()},getFileData:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,s,i,o,u;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["a"])(e[0]);case 2:if(n=a.sent,s=r.imgData[t].size.split("X"),n.w===Number(s[0])&&n.h===Number(s[1])){a.next=7;break}return r.$message.error("请上传尺寸为".concat(r.imgData[t].size,"的图片")),a.abrupt("return");case 7:return a.next=9,Object(c["a"])(e[1]);case 9:if(i=a.sent,o=i.err,u=i.res,!o){a.next=15;break}return r.$message.error(o.msg),a.abrupt("return");case 15:r.form[r.imgData[t].prop]=u.data.file_path;case 16:case"end":return a.stop()}}),a)})))()},clear:function(){this.$refs["ruleForm"].resetFields()},routeTo:function(){this.$router.push({path:"/classify-manage"})},confirm:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.submit()}))},submit:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.disabled=!0,e.$route.query.id){t.next=7;break}return t.next=4,e.$post("/admin/categories",e.form);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,e.$put("/admin/categories/".concat(e.$route.query.id),e.form);case 9:t.t0=t.sent;case 10:r=t.t0,a=r.err,r.res,e.disabled=!1,a?e.$message.error(a.msg):(e.$message({type:"success",message:"保存成功"}),e.routeTo());case 15:case"end":return t.stop()}}),t)})))()}}},m=u,p=(r("de72"),r("cba8")),d=Object(p["a"])(m,a,n,!1,null,"44dc8008",null);t["a"]=d.exports},de72:function(e,t,r){"use strict";r("98cd")}}]);