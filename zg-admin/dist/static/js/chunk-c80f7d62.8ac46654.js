(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c80f7d62"],{"77fa":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"account-mgt"},[r("div",{staticClass:"user-head"},[r("el-form",{attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"手机号"}},[r("el-input",{attrs:{placeholder:"请输入手机号",clearable:"",size:"mini",maxlength:30},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),r("el-form-item",{attrs:{label:"姓名"}},[r("el-input",{attrs:{size:"mini",placeholder:"请输入姓名",maxlength:30,clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),r("el-form-item",{attrs:{label:"状态"}},[r("el-select",{attrs:{size:"mini",placeholder:"请选择用户状态",filterable:"",clearable:""},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search()}},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.userStatus,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("base-btn",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("搜索")]),r("base-btn",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.clear(t)}}},[e._v("清除")])],1),r("div",[r("base-btn",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.addUser(t)}}},[e._v("新建用户")])],1)],1),r("p",[e._v("当前条件下共"+e._s(e.total)+"条数据")]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.userData,border:""}},[r("el-table-column",{attrs:{prop:"username",label:"手机号"}}),r("el-table-column",{attrs:{prop:"nickname",label:"姓名"}}),r("el-table-column",{attrs:{prop:"work",label:"权限",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.work)+" ")]}}])}),r("el-table-column",{attrs:{prop:"status",label:"状态"}}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("base-btn",{attrs:{type:"text"},nativeOn:{click:function(r){return e.updateUser(t.row)}}},[e._v("编辑")]),"正常"==t.row.status?r("base-btn",{attrs:{type:"text"},nativeOn:{click:function(r){return e.deleteUser(t.row.user_id,"禁用")}}},[e._v("禁用")]):r("base-btn",{attrs:{type:"text"},nativeOn:{click:function(r){return e.deleteUser(t.row.user_id,"正常")}}},[e._v("恢复")])]}}])})],1),r("base-pag",{attrs:{total:e.total,limit:e.pageSize,page:e.currentPage},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}),r("base-dialog",{attrs:{show:e.dialogVisible,title:e.dialogTitle,width:"500px"},on:{"update:show":function(t){e.dialogVisible=t}}},[r("add",{attrs:{"user-data":e.userInfo},on:{close:e.close}})],1)],1)},s=[],a=r("06c4"),i=r("e9ff"),o=(r("08ba"),r("fe8a"),r("e186"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"add-person"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"90px","label-position":"left"}},[r("el-form-item",{attrs:{label:"手机号",prop:"username"}},[r("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username","string"===typeof t?t.trim():t)},expression:"ruleForm.username"}})],1),r("el-form-item",{attrs:{label:"姓名",prop:"nickname"}},[r("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.ruleForm.nickname,callback:function(t){e.$set(e.ruleForm,"nickname","string"===typeof t?t.trim():t)},expression:"ruleForm.nickname"}})],1),r("el-form-item",{attrs:{label:"密码",prop:e.userData.user_id?"":"password"}},[r("el-input",{attrs:{placeholder:"请输入密码",autocomplete:"new-password",type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password","string"===typeof t?t.trim():t)},expression:"ruleForm.password"}})],1),r("el-form-item",{attrs:{label:"业务",prop:"work"}},[r("el-checkbox-group",{model:{value:e.ruleForm.work,callback:function(t){e.$set(e.ruleForm,"work",t)},expression:"ruleForm.work"}},e._l(e.bussinessList,(function(t){return r("el-checkbox",{key:t,attrs:{label:t,name:t}},[e._v(e._s(t))])})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")]),r("el-button",{on:{click:e.close}},[e._v("取消")])],1)],1)],1)}),u=[],l=(r("e35a"),r("0d7a"),r("9302"),{username:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"目前只支持中国大陆的手机号码",trigger:"blur"}],nickname:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],work:[{required:!0,message:"请选择业务",trigger:"blur"}]}),c=r("7394"),m=r.n(c),d=r("52c1"),f={components:{},props:{userData:{type:Object,default:function(){return{}}}},data:function(){return{rules:l,ruleForm:{username:"",nickname:"",password:"",work:[]}}},computed:Object(a["a"])(Object(a["a"])({},Object(d["b"])(["adminMenus"])),{},{bussinessList:function(){return this.adminMenus.split(",")}}),watch:{},created:function(){this.userData.user_id&&(this.ruleForm=JSON.parse(JSON.stringify(this.userData)),this.ruleForm.work=this.ruleForm.work.split(","))},mounted:function(){},methods:{close:function(){this.$emit("close")},resetForm:function(){this.$refs["ruleForm"].resetFields()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var r=JSON.parse(JSON.stringify(t.ruleForm));r.work=r.work.join(","),r.password?r.password=m()(r.password):delete r["password"],t.userAdd(r)}))},userAdd:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$post("/admin/admin-user/user-add",e);case 2:n=r.sent,s=n.err,n.res,s?t.$message.error(s.msg):(t.close(),a=t.userData.user_id?"编辑成功":"新建成功",t.$message({message:a,type:"success"}));case 6:case"end":return r.stop()}}),r)})))()}}},p=f,b=r("cba8"),g=Object(b["a"])(p,o,u,!1,null,"8d20d182",null),h=g.exports,k={components:{add:h},data:function(){return{showAddModel:!1,form:{nickname:"",username:"",status:""},dialogTitle:"",dialogVisible:!1,pageSize:10,currentPage:1,total:0,userData:[],loading:!1,userStatus:["正常","禁用"],userInfo:{}}},computed:{},watch:{},created:function(){this.getUserList()},mounted:function(){},methods:{handleCurrentChange:function(e){this.currentPage=e,this.getUserList()},handleSizeChange:function(e){this.pageSize=e,this.getUserList()},getUserList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,n,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=Object(a["a"])({page:e.currentPage,limit:e.pageSize},e.form),t.next=3,e.$get("/admin/admin-user/user-list",r);case 3:if(n=t.sent,s=n.err,i=n.res,!s){t.next=9;break}return e.$message.error(s.msg),t.abrupt("return");case 9:e.userData=i.data.list,e.total=i.data.total;case 11:case"end":return t.stop()}}),t)})))()},close:function(){this.dialogVisible=!1,this.getUserList()},updateUser:function(e){this.dialogVisible=!0,this.dialogTitle="编辑用户",this.userInfo=e},addUser:function(){this.userInfo={},this.dialogVisible=!0,this.dialogTitle="新建用户"},deleteUser:function(e,t){var r=this;"禁用"===t?this.$confirm("确定要禁用此用户吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.changeStatus(e,t)})).catch((function(){r.$message({type:"info",message:"已取消禁用"})})):this.changeStatus(e,t)},changeStatus:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var s,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s={user_id:e,status:t},n.next=3,r.$post("/admin/admin-user/change-status",s);case 3:if(a=n.sent,i=a.err,a.res,!i){n.next=9;break}return r.$message.error(i.msg),n.abrupt("return");case 9:r.getUserList();case 10:case"end":return n.stop()}}),n)})))()},clear:function(){var e=this;Object.keys(this.form).forEach((function(t){e.form[t]=""})),this.getUserList()},search:function(){this.page=1,this.getUserList()}}},w=k,v=(r("79e9"),Object(b["a"])(w,n,s,!1,null,"5f123d0a",null));t["default"]=v.exports},"79e9":function(e,t,r){"use strict";r("bcc2")},9302:function(e,t,r){"use strict";var n=r("1c8b"),s=r("692f"),a=r("da10"),i=r("d7e1"),o=[].join,u=s!=Object,l=i("join",",");n({target:"Array",proto:!0,forced:u||!l},{join:function(e){return o.call(a(this),void 0===e?",":e)}})},bcc2:function(e,t,r){}}]);